!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.OctopusRTC=t():e.OctopusRTC=t()}(this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=10)}([function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return s(t,e),t},c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},l=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Handler=void 0;var d=a(r(28)),f=r(1),h=r(6),p=function(e){function t(){var t=e.call(this)||this;return t._logger=null,t._statistics=null,t._sensorstats=null,t._streamId="",t._direction="send",t._sendStream=new MediaStream,t._videoCustomBitrate=0,t._audioCustomBitrate=0,t._customFramerate=0,t._hasTrack=!1,t._isNegotiating=!1,t._transceiverArr=new Array,t._currentStream=null,t._pcStats=null,t._logger=f.logger.collect,t}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Handler"},enumerable:!1,configurable:!0}),t.prototype.close=function(){if(this._pc)try{this._statistics&&(this._statistics.stopInterval(),this._statistics=null),this._sensorstats&&(this._sensorstats=null),this.removeAllListeners(),this._pc.close(),this._pc.onicecandidate=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onnegotiationneeded=null,this._pc.onconnectionstatechange=null,this._pc.ontrack=null,this._isNegotiating=!1,this._hasTrack=!1}catch(e){}},t.prototype.run=function(e){var t=this,r=e.streamId,n=e.direction,i=e.iceServers,o=e.iceTransportPolicy;this._streamId=r,this._direction=n;try{this._pc=new RTCPeerConnection({iceServers:i||[],iceTransportPolicy:o||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"})}catch(e){throw new Error(e)}this._pc.onicecandidate=function(e){},this._pc.onicegatheringstatechange=function(e){t._logger.debug(r+"onicegatheringstatechange:::",t._pc.iceGatheringState)},this._pc.onsignalingstatechange=function(e){t._logger.debug(r+"onsignalingstatechange:::",t._pc.signalingState)},this._pc.onconnectionstatechange=function(e){t._logger.debug("onconnectionstatechange:::",e.currentTarget.connectionState)}},t.prototype.setLocalOfferSdp=function(e){return c(this,void 0,void 0,(function(){var t,r,n,i,o,s,a,c;return u(this,(function(u){if(t=new Array,"recv"==this._direction)t.push(this._pc.addTransceiver("audio",{direction:"recvonly"})),t.push(this._pc.addTransceiver("video",{direction:"recvonly"}));else{if(void 0===e)throw new Error("mediastream must be not exist.");if(r=e.mediastream,n=e.encodings,!r)throw new Error("mediastream must be not exist.");this._currentStream=r;try{for(i=l(r.getTracks()),o=i.next();!o.done;o=i.next())s=o.value,t.push(this._pc.addTransceiver(s,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n}))}catch(e){a={error:e}}finally{try{o&&!o.done&&(c=i.return)&&c.call(i)}finally{if(a)throw a.error}}}return this._transceiverArr=t,[2]}))}))},t.prototype.setRemoteAnswerSdp=function(e){var t=e.remoteAnswerSdp;return c(this,void 0,void 0,(function(){var e,r,n;return u(this,(function(i){switch(i.label){case 0:e=0!==this._videoCustomBitrate||0!==this._audioCustomBitrate?this.setSdpCustomBitrate(t):t,r={type:"answer",sdp:e},i.label=1;case 1:return i.trys.push([1,3,,4]),this._logger.report("remote answersdp",r),[4,this._pc.setRemoteDescription(r)];case 2:return i.sent(),[3,4];case 3:return n=i.sent(),this._logger.report("set remote answersdp error",{streamId:this._streamId,reason:n}),this._logger.error("set remote answersdp error."),[3,4];case 4:return[2]}}))}))},t.prototype.setIceCandidate=function(e){for(var t=this,r=0;r<e.length;r+=1){var n=new RTCIceCandidate(e[r]);this._pc.addIceCandidate(n).catch((function(e){t._logger.error("addIceCandidate",e)}))}},t.prototype.stopTransceiver=function(){var e,t,r,n,i=this._transceiverArr;if(!i)throw new Error("associated RTCRtpTransceiver not found");if("closed"!==this._pc.signalingState)try{for(var o=l(i),s=o.next();!s.done;s=o.next()){(u=s.value).sender.replaceTrack(null),this._pc.removeTrack(u.sender)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}if(null!=this._currentStream)try{for(var a=l(this._currentStream.getTracks()),c=a.next();!c.done;c=a.next()){var u;(u=c.value).stop()}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}this.close()},t.prototype.getLocalOfferSdp=function(){return c(this,void 0,void 0,(function(){var e=this;return u(this,(function(t){return[2,new Promise((function(t,r){e._pc.onnegotiationneeded=function(r){return c(e,void 0,void 0,(function(){var e,r;return u(this,(function(n){switch(n.label){case 0:if(this._isNegotiating)return[2];this._isNegotiating=!0,n.label=1;case 1:return n.trys.push([1,7,,8]),[4,this._pc.createOffer()];case 2:e=n.sent(),r=void 0,r=0!==this._videoCustomBitrate||0!==this._audioCustomBitrate?this.setSdpCustomBitrate(e.sdp):e.sdp,this._logger.report("local offer sdp",r),n.label=3;case 3:return n.trys.push([3,5,,6]),[4,this._pc.setLocalDescription({type:"offer",sdp:r})];case 4:return n.sent(),[3,6];case 5:throw n.sent(),new Error("set local offer sdp error");case 6:return t({localOfferSdp:e.sdp}),[3,8];case 7:throw n.sent(),new Error("create local offer sdp error");case 8:return[2]}}))}))}}))]}))}))},t.prototype.getICEConnectionState=function(){var e=this;return new Promise((function(t,r){e._pc.oniceconnectionstatechange=function(r){switch(e._logger.report(e._streamId+"get connectionstatechange state:::",e._pc.iceConnectionState),e._pc.iceConnectionState){case"checking":break;case"connected":case"completed":var n="send"==e._direction?"PUBLISHING":"PLAYING";e._logger.info("stream "+n+" success."),t({state:n,code:1});break;case"failed":var i="send"==e._direction?"NO_PUBLISH":"NO_PLAY";e._logger.info("stream "+i),t({state:i,code:0})}}}))},t.prototype.getTrack=function(){var e=this;return new Promise((function(t,r){e._pc.ontrack=function(r){var n,i;if(!e._hasTrack&&(e._hasTrack=!0,e._logger.debug(e._streamId+"gettrack:::",r.streams.length),0!==r.streams.length)){try{for(var o=l(r.streams[0].getTracks()),s=o.next();!s.done;s=o.next()){var a=s.value;e._logger.debug(e._streamId+"gettrack kind:::",a)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}e._currentStream=r.streams[0],t(r.streams[0])}}}))},t.prototype.setCustomerValue=function(e){this._videoCustomBitrate=e.videoCustomBitrate,this._audioCustomBitrate=e.audioCustomBitrate,this._customFramerate=e.customFramerate},t.prototype.setSdpCustomBitrate=function(e){var t,r,n,i;if(0!==this._videoCustomBitrate||0!==this._audioCustomBitrate){var o=d.parse(e),s=o.media;try{for(var a=l(s),c=a.next();!c.done;c=a.next()){var u=c.value,f=u.fmtp;try{for(var h=(n=void 0,l(f)),p=h.next();!p.done;p=h.next()){var m=p.value;if("video"===u.type&&0!==this._videoCustomBitrate)d.parseParams(m.config)["profile-level-id"]&&(m.config+=";x-google-max-bitrate="+this._videoCustomBitrate+";x-google-min-bitrate="+this._videoCustomBitrate+";x-google-start-bitrate="+this._videoCustomBitrate);else"audio"===u.type&&0!==this._audioCustomBitrate&&(m.config+=";maxaveragebitrate="+this._audioCustomBitrate)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return d.write(o)}throw new RangeError("customBitRate value not invalid")},t.prototype.replaceTrack=function(e){return c(this,void 0,void 0,(function(){var t,r;return u(this,(function(n){switch(n.label){case 0:t=this._pc.getSenders().find((function(t){if(!t.track)throw new Error("mediastreamTrack is not exist.");return t.track.kind==e.kind})),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,t.replaceTrack(e)];case 2:return n.sent(),[3,4];case 3:throw r=n.sent(),new Error(r);case 4:return[2]}}))}))},t.prototype.transportStats=function(e){return c(this,void 0,void 0,(function(){var t;return u(this,(function(r){switch(r.label){case 0:return null==this._pcStats&&(this._pcStats=new h.pcStats({framerate:this._customFramerate,bitrate:this._videoCustomBitrate,direction:this._direction})),[4,this._pc.getStats()];case 1:switch(t=r.sent(),this._pcStats.collectRTCStatsReport(t),e){case h.type.LocalAudio:return[2,this._pcStats.getLocalAudioStats()];case h.type.LocalVideo:return[2,this._pcStats.getLocalVideoStats()];case h.type.RemoteAudio:return[2,this._pcStats.getRemoteAudioStats()];case h.type.RemoteVideo:return[2,this._pcStats.getRemoteVideoStats()];case h.type.Sensor:case h.type.Crystalball:return[2,{crystalBall:this._pcStats.getCrystalballStats(),sensor:this._pcStats.getSensorStats()}]}return[2]}}))}))},t.prototype._assertSendDirection=function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')},t.prototype._assertRecvDirection=function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')},t}(r(31).HandlerInterface);t.Handler=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateLoggerInstance=t.logger=void 0;var n=r(11);t.logger={},t.generateLoggerInstance=function(e){var r=new n.Log(e);Object.defineProperty(t.logger,"collect",{value:r,writable:!1,enumerable:!1,configurable:!0})}},function(e,t,r){var n;e.exports=function e(t,r,i){function o(a,c){if(!r[a]){if(!t[a]){if(!c&&"function"==typeof n&&n)return n(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,(function(e){return o(t[a][1][e]||e)}),l,l.exports,e,t,r,i)}return r[a].exports}for(var s="function"==typeof n&&n,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,i="~";function o(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,r,n,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new s(r,n||e,o),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function u(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,o=r.length,s=new Array(o);n<o;n++)s[n]=r[n].fn;return s},u.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,o,s){var a=i?i+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,o),!0;case 6:return l.fn.call(l.context,t,r,n,o,s),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var f,h=l.length;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,n);break;default:if(!c)for(f=1,c=new Array(d-1);f<d;f++)c[f-1]=arguments[f];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return c(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||n&&!s.once||r&&s.context!==r||c(this,o);else{for(var a=0,u=[],l=s.length;a<l;a++)(s[a].fn!==t||n&&!s[a].once||r&&s[a].context!==r)&&u.push(s[a]);u.length?this._events[o]=1===u.length?u[0]:u:c(this,o)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&c(this,t)):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,void 0!==t&&(t.exports=u)},{}]},{},[1])(1)},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return o(t,e),t},a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.uploadLog=t.getAuthEdgeList=t.getEdgeList=t.getUserSource=t.uploadSensorsStats=t.numberVersion=void 0;var u=s(r(7)),l=r(12),d=r(4),f=null,h="",p="";function m(e){return a(this,void 0,void 0,(function(){var t,r;return c(this,(function(n){switch(n.label){case 0:if(e.method||(e.method="GET"),e.data){if("object"!=typeof e.data)throw new Error("data must be an object.");t=e.data.headers?{body:JSON.stringify(e.data),method:e.method,headers:e.data.headers}:{body:JSON.stringify(e.data),method:e.method}}else t={method:e.method};n.label=1;case 1:return n.trys.push([1,4,,5]),[4,fetch(e.url,t)];case 2:return[4,n.sent().json()];case 3:return[2,n.sent()];case 4:throw r=n.sent(),new Error(r);case 5:return[2]}}))}))}function y(){var e=[];return d.version.split(".").forEach((function(t){t.length<=1&&(t+="0"),e.push(t)})),parseInt(e.join("")+"0")}function _(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")}function g(){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,m({url:"https://geoip.linkv.fun/ip_geo",method:"GET"})];case 1:return[2,e.sent()]}}))}))}t.numberVersion=y,t.uploadSensorsStats=function(e){return a(this,void 0,void 0,(function(){var t;return c(this,(function(r){switch(r.label){case 0:return t=function(){var e=y(),t=0;if(navigator.connection||navigator.mozConnection||navigator.webkitConnection){var r=(navigator.connection||navigator.mozConnection||navigator.webkitConnection).type;t="wifi"==r?1:"2g"==r?2:"3g"==r?3:"4g"==r?4:"5g"==r?5:0}var n=u.parse(window.navigator.userAgent),i=n.browser,o=n.engine,s=n.os,a=n.platform;return{os_type:a.type,brand:a.vendor,model:""+i.name+i.version,system_version:s.version,system_name:s.name,system_versionName:s.versionName,app_version:i.version,app_engine:o.name,sdk_version:d.version,sdk_version_int:e,net_type:t}}(),[4,m({url:l.constantConfig.STATSURL+"/data_collect",method:"POST",data:n(n(n({},t),e),{event_time:Math.round((new Date).getTime()/1e3),time:(new Date).getTime()})})];case 1:if(200!==r.sent().status)throw new Error("sensors stats error.");return[2]}}))}))},t.getUserSource=function(){return u.parse(window.navigator.userAgent).platform.type},t.getEdgeList=function(e){return a(this,void 0,void 0,(function(){var t,r;return c(this,(function(n){switch(n.label){case 0:return t=l.envConfig[e.projectName][e.env],null!=f?[3,2]:[4,g()];case 1:f=n.sent(),n.label=2;case 2:return[4,m({url:t.CENTERURL+"/api/v1/join",method:"POST",data:{app_id:e.appId,user_id:e.userId,client_ip:f&&f.client_ip,proto:"https",role:"",room_id:e.roomId,user_source:"pc_center"},headers:{"Content-Type":"application/json"}})];case 3:if(200!==(r=n.sent()).code)throw new Error("get EdgeList failed.");return[2,r.data.edge_urls]}}))}))},t.getAuthEdgeList=function(e){var t=e.appId,r=e.auth,i=e.expire,o=e.projectName,s=e.env;return a(this,void 0,void 0,(function(){var e,a;return c(this,(function(c){switch(c.label){case 0:return e=l.envConfig[o][s],null!=f?[3,2]:[4,g()];case 1:f=c.sent(),c.label=2;case 2:return[4,m({url:e.CENTERURL+"/api/v1/auth",method:"POST",data:n({app_id:t,auth:r,timestamp:""+Math.round((new Date).getTime()/1e3),expire_ts:i,user_source:"pc_center",nonce:_()},f)})];case 3:if(200!==(a=c.sent()).code)throw new Error("get EdgeList failed.");return[2,a.data.edge_urls]}}))}))},t.uploadLog=function(e){var t=e.appId,r=e.userId,n=e.message;return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return null!=f?[3,2]:[4,g()];case 1:f=e.sent(),e.label=2;case 2:if(t)h=t;else if(!h)throw new Error("appId can not be empty.");if(r)p=r;else if(!p)throw new Error("userId can not be empty.");return[4,m({url:l.constantConfig.LOGREPORT+"/v1/log/report",method:"POST",data:{appid:h,userid:p,country:f&&f.country_code,message:n,timestamp:Math.round((new Date).getTime()/1e3)}})];case 3:return[2,e.sent()]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENV=t.projectName=t.version=void 0,t.version="2.0.2-alpha",t.projectName="liveme",t.ENV="production"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errCode=t.lackErrCode=void 0,t.lackErrCode=function(e){return{code:7e5,msg:"LACK OF "+e.toUpperCase()}},t.errCode=new Map([["wsDisconnect",{code:5e5,msg:"WS_DISCONNECT"}],["kickOut",{code:500001,msg:"WS_KICK_OUT"}],["constrainChangeSuccess",{code:6e5,msg:"CONSTRAIN_CHANGE_SUCCESS"}],["overConstrainedError",{code:600001,msg:"OVERCONSTRAINEDERROR"}],["devicesSupportError",{code:600002,msg:"DEVICES_NOT_SUPPORTED"}],["constrainChangeFailed",{code:600003,msg:"STREAM_NOT_EXIST"}],["nullEdgeList",{code:4e5,msg:"EDGE_LIST_NULL"}]])},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.pcStats=t.standard=t.type=void 0,function(e){e[e.LocalAudio=0]="LocalAudio",e[e.LocalVideo=1]="LocalVideo",e[e.RemoteAudio=2]="RemoteAudio",e[e.RemoteVideo=3]="RemoteVideo",e[e.Crystalball=4]="Crystalball",e[e.Sensor=5]="Sensor"}(t.type||(t.type={})),function(e){e[e.freezeFrameRate=8]="freezeFrameRate",e[e.audioFreezeRate=.04]="audioFreezeRate"}(n=t.standard||(t.standard={}));var i=function(){function e(e){this._direction="send",this._interval=1e3,this._mapCodecId=new Map,this._targetFramerate=0,this._audioCodecId="",this._videoCodecId="",this._sendCountFreezeTimes=0,this._recvCountFreezeTimes=0,this._startTime=0,this._endTime=0,this._totalAudioFreezeTimes=0,this._totalAudioRecvTimes=0,this._currentRoundTripTime=0,this._totalRenderFrame=0,this._totalDecodeFrame=0,this._audioJitterDelay=0,this._videoJitterDelay=0,this._totalRecvFrameRate=0,this._totalfreezeFrame=0,this._audioSendCodecType="aac",this._audioSendBitrate=0,this._audioSendBytes=0,this._audioSendPackets=0,this._andioSendPacketsLost=0,this._sendVolumeLevel=0,this._captureFrameRate=0,this._captureResolutionHeight=0,this._captureResolutionWidth=0,this._videoSendCodecType="H264",this._encodeDelay=0,this._videoSendBitrate=0,this._videoSendBytes=0,this._videoSendPackets=0,this._videoSendPacketsLost=0,this._sendResolutionHeight=0,this._sendResolutionWidth=0,this._targetSendBitrate=0,this._sendTotalDuration=0,this._sendTotalFreezeTime=0,this._audioRecvCodecType="aac",this._audioEnd2EndDelay=0,this._audioFreezeRate=0,this._audioPacketLossRate=0,this._audioPublishDuration=0,this._audioReceiveBitrate=0,this._audioReceiveBytes=0,this._audioReceiveDelay=0,this._receiveLevel=0,this._audioReceivePackets=0,this._audioReceivePacketsLost=0,this._recvAudioTotalDuration=0,this._recvAudioTotalFreezeTime=0,this._audioTransportDelay=0,this._videoRecvCodecType="H264",this._decodeFrameRate=0,this._videoEnd2EndDelay=0,this._videoFreezeRate=0,this._videoPacketLossRate=0,this._videoPublishDuration=0,this._videoReceiveBitrate=0,this._videoReceiveBytes=0,this._videoReceiveDelay=0,this._receiveFrameRate=0,this._videoReceivePackets=0,this._videoReceivePacketsLost=0,this._receiveResolutionHeight=0,this._receiveResolutionWidth=0,this._recvVideoTotalDuration=0,this._recvVideoTotalFreezeTime=0,this._videoTransportDelay=0,this._sendFramesEncoded=0,this._sendFramesSent=0,this._sendNackCount=0,this._sendPliCount=0,this._totalDecodeTime=0,this._firCount=0,this._recvNackCount=0,this._recvPliCount=0,this._sendBandwidth=0,this._direction=e.direction,void 0!==e&&(void 0!==e.framerate&&(this._targetFramerate=e.framerate),void 0!==e.bitrate&&(this._targetSendBitrate=e.bitrate))}return e.prototype.getLocalAudioStats=function(){return this._calculateTotalIndex(),{codecType:this._audioSendCodecType,sendBitrate:this._audioSendBitrate,sendBytes:this._audioSendBytes,sendPackets:this._audioSendPackets,sendPacketsLost:this._andioSendPacketsLost,sendVolumeLevel:this._sendVolumeLevel}},e.prototype.getLocalVideoStats=function(){return this._calculateTotalIndex(),{captureFrameRate:this._captureFrameRate,captureResolutionHeight:this._captureResolutionHeight,captureResolutionWidth:this._captureResolutionWidth,codecType:this._videoSendCodecType,encodeDelay:this._encodeDelay,sendBitrate:this._videoSendBitrate,sendBytes:this._videoSendBytes,sendFrameRate:this._sendFrameRate,sendPackets:this._videoSendPackets,sendPacketsLost:this._videoSendPacketsLost,sendResolutionHeight:this._sendResolutionHeight,sendResolutionWidth:this._sendResolutionWidth,targetSendBitrate:this._targetSendBitrate,totalDuration:this._sendTotalDuration,totalFreezeTime:this._sendTotalFreezeTime}},e.prototype.getRemoteAudioStats=function(){return this._calculateTotalIndex(),{codecType:this._audioRecvCodecType,freezeRate:this._audioFreezeRate,packetLossRate:this._audioPacketLossRate,publishDuration:this._audioPublishDuration,receiveBitrate:this._audioReceiveBitrate,receiveBytes:this._audioReceiveBytes,receiveDelay:this._audioReceiveDelay,receiveLevel:this._receiveLevel,receivePackets:this._audioReceivePackets,receivePacketsLost:this._audioReceivePacketsLost,totalDuration:this._recvAudioTotalDuration,totalFreezeTime:this._recvAudioTotalFreezeTime,transportDelay:this._audioTransportDelay}},e.prototype.getRemoteVideoStats=function(){return this._calculateTotalIndex(),{codecType:this._videoRecvCodecType,decodeFrameRate:this._decodeFrameRate,freezeRate:this._videoFreezeRate,packetLossRate:this._videoPacketLossRate,receiveBitrate:this._videoReceiveBitrate,receiveBytes:this._videoReceiveBytes,receiveDelay:this._videoReceiveDelay,receiveFrameRate:this._receiveFrameRate,receivePackets:this._videoReceivePackets,receivePacketsLost:this._videoReceivePacketsLost,receiveResolutionHeight:this._receiveResolutionHeight,receiveResolutionWidth:this._receiveResolutionWidth,renderFrameRate:this._renderFrameRate,totalDuration:this._recvVideoTotalDuration,totalFreezeTime:this._recvVideoTotalFreezeTime,transportDelay:this._videoTransportDelay}},e.prototype.getSensorStats=function(){this._calculateTotalIndex();var e={a_send_bitrate:this._audioSendBitrate,is_send:1,v_actual_bitrate:this._videoSendBitrate,v_encode_cost:this._encodeDelay,v_frame_encode:this._sendFramesEncoded,v_frame_sent:this._sendFramesSent,v_input_frame_rate:this._targetFramerate,v_nack_pli:this._sendNackCount,v_send_frame_rate:this._sendFrameRate,v_send_packets:this._videoSendPackets,v_send_pli:this._sendPliCount,v_target_bitrate:this._targetSendBitrate},t={is_send:0,a_recv_bitrate:this._audioReceiveBitrate,a_recv_packets:this._audioReceivePackets,a_lost_packets:this._audioReceivePacketsLost,v_recv_bitrate:this._videoReceiveBitrate,v_decode_cost:this._totalDecodeTime,v_lost_packets:this._videoReceivePacketsLost,v_recv_firs:this._firCount,v_recv_frame_rate:this._receiveFrameRate,v_recv_nack:this._recvNackCount,v_recv_plis:this._recvPliCount};return"send"===this._direction?e:t},e.prototype.getCrystalballStats=function(){this._calculateTotalIndex();var e={};if("send"===this._direction){var t=this._encodeDelay?1e3*this._encodeDelay:0,r={VSendBitrate1:this._videoSendBitrate,ASendBitrate:this._audioSendBitrate,SendBandwidth:this._sendBandwidth,SendRTT:1e3*this._currentRoundTripTime,EncodeCost:t,VFrameRate1:this._sendFrameRate,VFrameRate2:this._targetFramerate,VSendFrameRate1:this._sendFrameRate,VSendLostPercent:this._videoPacketLossRate,ASendLostPercent:this._audioPacketLossRate,nack_receive_times:this._sendNackCount,pli_receive_times:this._sendPliCount};for(var n in r)r.hasOwnProperty(n)&&r[n]&&(e[n]=Math.round(r[n]))}else if("recv"===this._direction){var i={VRecvBitrate:this._videoReceiveBitrate,ARecvBitrate:this._audioReceiveBitrate,RecvRTT:1e3*this._currentRoundTripTime,DecodeCost:1e3*this._totalDecodeTime,VFrameRate:this._receiveFrameRate,VRecvLostPercent:this._videoReceivePacketsLost,ARecvLostPercent:this._audioReceivePacketsLost};for(var n in i)i.hasOwnProperty(n)&&i[n]&&(e[n]=Math.round(i[n]))}return e},e.prototype.collectRTCStatsReport=function(e){this._analysisRTCStatsReport(e)},e.prototype._analysisRTCStatsReport=function(e){var t=this;e.forEach((function(e){t._startTime||(t._startTime=e.timestamp),t._endTime=e.timestamp,t._interval=t._endTime-t._startTime+1e3;var r=e.id,i=e.type,o=e.kind||e.mediaType;"codec"===i?t._mapCodecId.set(r,e.mimeType):"candidate-pair"===i?(t._currentRoundTripTime=e.currentRoundTripTime,t._sendBandwidth=e.availableOutgoingBitrate):"track"===i?"audio"===o?t._audioJitterDelay=e.jitterBufferDelay/e.jitterBufferEmittedCount:"video"===o&&(t._videoJitterDelay=e.jitterBufferDelay/e.jitterBufferEmittedCount):"media-source"===i?"audio"===o?t._sendVolumeLevel=e.audioLevel:"video"===o&&(t._captureFrameRate=e.framesPerSecond,t._captureResolutionWidth=e.width,t._captureResolutionHeight=e.height):"remote-inbound-rtp"===i?"audio"===o?t._andioSendPacketsLost=e.packetsLost:"video"===o&&(t._videoSendPacketsLost=e.packetsLost):"outbound-rtp"===i?"audio"===o?(t._audioCodecId=e.codecId,t._audioSendBitrate=t._calculateKBitsPerSecond(e.bytesSent),t._audioSendBytes=e.bytesSent,t._audioSendPackets=e.packetsSent):"video"===o&&(t._videoCodecId=e.codecId,t._encodeDelay=e.totalEncodeTime,t._videoSendBitrate=t._calculateKBitsPerSecond(e.bytesSent),t._videoSendBytes=e.bytesSent,t._sendFrameRate=e.framesPerSecond,t._videoSendPackets=e.packetsSent,t._sendResolutionHeight=e.frameHeight,t._sendResolutionWidth=e.frameWidth,t._sendFramesEncoded=e.framesEncoded,t._sendFramesSent=e.framesSent,t._sendNackCount=e.nackCount,t._sendPliCount=e.pliCount,e.framesPerSecond<=n.freezeFrameRate&&(t._sendCountFreezeTimes+=1)):"inbound-rtp"===i&&("audio"===o?(t._audioCodecId=e.codecId,t._audioPublishDuration=e.totalSamplesDuration,t._audioReceiveBitrate=t._calculateKBitsPerSecond(e.bytesReceived),t._audioReceiveBytes=e.bytesReceived,t._receiveLevel=e.audioLevel,t._audioReceivePackets=e.packetsReceived,t._audioReceivePacketsLost=e.packetsLost,t._audioPacketLossRate=t._calcuatePacketsLostRatio(e.packetsLost,e.packetsReceived),t._audioReceivePacketsLost/(t._audioReceivePackets+t._audioReceivePacketsLost)>=n.audioFreezeRate&&(t._totalAudioFreezeTimes+=1),t._totalAudioRecvTimes+=1):"video"===o&&(t._videoCodecId=e.codecId,t._videoReceiveBitrate=t._calculateKBitsPerSecond(e.bytesReceived),t._videoReceiveBytes=e.bytesReceived,t._receiveFrameRate=e.framesPerSecond||0,t._videoReceivePackets=e.packetsReceived,t._videoReceivePacketsLost=e.packetsLost,t._receiveResolutionHeight=e.frameHeight,t._receiveResolutionWidth=e.frameWidth,t._videoPacketLossRate=t._calcuatePacketsLostRatio(e.packetsLost,e.packetsReceived),t._totalRenderFrame=e.framesDecoded-e.framesDropped,t._totalDecodeFrame=e.framesDecoded,t._totalRecvFrameRate+=e.framesPerSecond||0,t._totalDecodeTime=e.totalDecodeTime,t._recvNackCount=e.nackCount,t._recvPliCount=e.pliCount,e.framesPerSecond<=n.freezeFrameRate&&(t._recvCountFreezeTimes+=1,t._totalfreezeFrame+=e.framesPerSecond)))}));var r=this._mapCodecId.get(this._audioCodecId),i=this._mapCodecId.get(this._videoCodecId);"send"===this._direction?(this._audioSendCodecType=null==r?void 0:r.split("/")[1],this._videoSendCodecType=null==i?void 0:i.split("/")[1]):(this._audioRecvCodecType=null==r?void 0:r.split("/")[1],this._videoRecvCodecType=null==i?void 0:i.split("/")[1],this._audioTransportDelay=this._currentRoundTripTime/2,this._videoTransportDelay=this._currentRoundTripTime/2,this._audioReceiveDelay=this._audioTransportDelay+this._audioJitterDelay,this._videoReceiveDelay=this._videoTransportDelay+this._videoJitterDelay)},e.prototype._calculateTotalIndex=function(){"send"===this._direction?(this._sendTotalDuration=.001*(this._endTime-this._startTime),this._sendTotalFreezeTime=this._sendCountFreezeTimes*this._interval/1e3):(this._recvVideoTotalDuration=.001*(this._endTime-this._startTime),this._audioFreezeRate=this._totalAudioFreezeTimes/this._totalAudioRecvTimes,this._renderFrameRate=this._totalRenderFrame/(.001*this._interval),this._decodeFrameRate=this._totalDecodeFrame/(.001*this._interval),this._recvAudioTotalFreezeTime=this._totalAudioFreezeTimes*this._interval*.001,this._recvVideoTotalFreezeTime=this._recvCountFreezeTimes*this._interval*.001,this._videoFreezeRate=this._totalfreezeFrame/this._totalRecvFrameRate)},e.prototype._calculateKBitsPerSecond=function(e){return Math.round(.008*e/(.001*this._interval))},e.prototype._calcuatePacketsLostRatio=function(e,t){return 0===e&&0===t?0:e/(e+t)},e.prototype._calculatePacketsPerSecond=function(e,t){return e/(.001*t)},e.prototype._calcuateFramesPerSecond=function(e,t){return Math.round(e/(.001*t))},e}();t.pcStats=i},function(e,t,r){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(r),s=Math.max(i,o),a=0,c=e.map([t,r],(function(t){var r=s-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(a=s-Math.min(i,o)),s-=1;s>=a;){if(c[0][s]>c[1][s])return 1;if(c[0][s]===c[1][s]){if(s===a)return 0;s-=1}else if(c[0][s]<c[1][s])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var a=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=o.length;t<r;t+=1)a();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},o=r(18);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){}var t,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,(r=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&s(t,r),e}();t.default=a,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=c(r(92)),i=c(r(93)),o=c(r(94)),s=c(r(95)),a=c(r(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=a.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=a.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=a.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=a.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return a.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},o=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(i[t]=s,o+=1):"object"==typeof s&&(r[t]=s,n+=1)})),n>0){var s=Object.keys(r),c=a.default.find(s,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(r[c]);if(void 0!==u)return u}var l=a.default.find(s,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(r[l]);if(void 0!==d)return d}}if(o>0){var f=Object.keys(i),h=a.default.find(f,(function(e){return t.isBrowser(e,!0)}));if(void 0!==h)return this.compareVersion(i[h])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=a.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(a.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e){return this.isBrowser(e)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(e){var t=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return{name:o.OS_MAP.iOS,version:t}}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=i.default.getMacOSVersionName(t),n={name:o.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:o.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:o.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=s,e.exports=t.default}})},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome68=void 0;var c=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Chrome68"},enumerable:!1,configurable:!0}),t.prototype.setLocalOfferSdp=function(e){return o(this,void 0,void 0,(function(){var t,r,n,i,o,c;return s(this,(function(s){if("send"===this._direction){if(void 0===e)throw new Error("mediastream must be not exist.");if(t=e.mediastream,e.encodings,void 0===t)throw new Error("mediastream must be not exist.");try{for(r=a(t.getTracks()),n=r.next();!n.done;n=r.next())i=n.value,this._pc.addTrack(i,this._sendStream)}catch(e){o={error:e}}finally{try{n&&!n.done&&(c=r.return)&&c.call(r)}finally{if(o)throw o.error}}this._currentStream=t}return[2]}))}))},t.prototype.getLocalOfferSdp=function(){return o(this,void 0,void 0,(function(){var e,t,r;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e={offerToReceiveAudio:!1,offerToReceiveVideo:!1},"recv"===this._direction&&(e={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),[4,this._pc.createOffer(e)];case 1:return t=n.sent(),r=void 0,r=0!==this._videoCustomBitrate||0!==this._audioCustomBitrate?this.setSdpCustomBitrate(t.sdp):t.sdp,[4,this._pc.setLocalDescription({type:"offer",sdp:r})];case 2:return n.sent(),[2,{localOfferSdp:t.sdp}];case 3:throw n.sent(),new Error("set local offer sdp error");case 4:return[2]}}))}))},t}(r(0).Handler);t.Chrome68=c},function(e,t){var r=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(r).forEach((function(e){r[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=c(r(2)),l=r(1),d=r(4),f=r(13),h=r(6),p=c(r(42)),m=r(43),y=function(e){function t(t){var r=e.call(this)||this;if(r._roomId="",r._userId="",r._userName="",r._octopusConfig=null,r._octopusClient=null,r._appId="",r._env="prod",r._type=null,r._customEdgeUrl="",r._version=d.version,r._logger=null,r._record=null,r._appPackageName="",!t.appId)throw new Error("appId can not be empty.");if(!t.userId)throw new Error("userId can not be empty.");return r._userId=t.userId,r._appId=t.appId,void 0!==t&&(void 0!==t.userName&&(r._userName=t.userName),void 0!==t.env&&(r._env=t.env),void 0!==t.type&&(r._type=t.type),void 0!==t.edgeUrl&&(r._customEdgeUrl=t.edgeUrl),void 0!==t.appPackageName&&(r._appPackageName=t.appPackageName)),l.generateLoggerInstance({appId:r._appId,userId:r._userId}),r._logger=l.logger.collect,r}return i(t,e),Object.defineProperty(t.prototype,"roomId",{get:function(){return this._roomId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userName",{get:function(){return this._userName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.isSupported=function(){var e=window.RTCPeerConnection||window.webkitRTCPeerConnection,t=navigator.getUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=window.WebSocket;return!!e&&!!t&&!!r},t.prototype.init=function(){if(!d.projectName&&!this._type)throw new Error("type can not be empty.");var e=d.projectName;this._type&&(e="china"==this._type?"cm":"liveme"),this._octopusConfig={appId:this._appId,env:this._env,projectName:e,userId:this._userId,userName:this._userName,customEdgeUrl:this._customEdgeUrl},this._octopusClient=new f.OctopusClientTest(this._octopusConfig),this._logger.info("init params",this._octopusConfig),this.eventemitFunctions()},t.prototype.login=function(e,t,r,n){return o(this,void 0,void 0,(function(){var i,o,c,u,l,d,f,h;return s(this,(function(s){switch(s.label){case 0:if(this._logger.info("login start",{roomId:e,role:t,auth:r,expire:n}),this._roomId=e,!this._octopusClient)throw new Error("OctopusRTC is not a instance.");i=[],s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._octopusClient.login(this._appPackageName,this._roomId,t,r,n)];case 2:if(!("code"in(o=s.sent())))try{for(c=a(o),u=c.next();!u.done;u=c.next())l=u.value,i.push({streamId:l.streamId,userId:l.userId,roomId:l.roomId})}catch(e){f={error:e}}finally{try{u&&!u.done&&(h=c.return)&&h.call(c)}finally{if(f)throw f.error}}return this._logger.info("login success",i),[2,i];case 3:return d=s.sent(),this._logger.info("login failed",d),[2,d];case 4:return[2]}}))}))},t.prototype.logout=function(){if(!this._octopusClient)throw new Error("OctopusRTC is not a instance.");this.removeAllListeners(),this._logger.disableLogUpload(),this._octopusClient.logout()},t.prototype.createStream=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){return this._logger.info("createStream params",e),[2,this._octopusClient.createStream(e)]}))}))},t.prototype.destroyStream=function(e){if(!this._octopusClient)throw new Error("OctopusRTC is not a instance.");this._octopusClient.destroyStream(e)},t.prototype.startPublishingStream=function(e,t,r,n){return o(this,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return this._logger.info("start publish stream",{streamId:e,mediaElement:t}),this._octopusClient?[4,this._octopusClient.startPublishingStream(e,t,r,n)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},t.prototype.stopPublishingStream=function(e){this._logger.info("stop publish stream",e),this._octopusClient&&this._octopusClient.stopPublishingStream(e)},t.prototype.startPlayingStream=function(e,t,r){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return this._logger.info("start play stream.",{pullstreamUserId:e}),this._octopusClient?[4,this._octopusClient.startPlayingStream(e,t,r)]:[3,2];case 1:return[2,n.sent()];case 2:return[2]}}))}))},t.prototype.stopPlayingStream=function(e){this._logger.info("stop play stream",e),this._octopusClient&&this._octopusClient.stopPlayingStream(e)},t.prototype.updateMixStream=function(e){var t=this;return new Promise((function(r,n){t._octopusClient&&t._octopusClient.updateMixStream(e,(function(e){r(e)}),(function(e){n(e)}))}))},t.prototype.replaceTrack=function(e,t,r){if(!this._octopusClient)throw new Error("OctopusRTC is not a instance.");this._octopusClient.replaceTrack(e,t,r)},t.prototype.changeConstraints=function(e,t,r,n){return o(this,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return this._octopusClient?[4,this._octopusClient.changeConstraints(e,t,r,n)]:[3,2];case 1:return[2,i.sent()];case 2:return[2]}}))}))},t.prototype.muteSwitch=function(e,t){this._octopusClient&&this._octopusClient.muteSwitch(e,t)},t.prototype.cameraSwitch=function(e,t){if(!this._octopusClient)throw new Error("OctopusRTC is not a instance.");this._octopusClient.cameraSwitch(e,t)},t.prototype.getLocalAudioStats=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:if(!this._octopusClient)throw new Error("OctopusRTC is not a instance.");return[4,this._octopusClient.getMediaStreamTrackStats(e,h.type.LocalAudio)];case 1:return[2,t.sent()]}}))}))},t.prototype.getLocalVideoStats=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:if(!this._octopusClient)throw new Error("OctopusRTC is not a instance.");return[4,this._octopusClient.getMediaStreamTrackStats(e,h.type.LocalVideo)];case 1:return[2,t.sent()]}}))}))},t.prototype.getRemoteAudioStats=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:if(!this._octopusClient)throw new Error("OctopusRTC is not a instance.");return[4,this._octopusClient.getMediaStreamTrackStats(e,h.type.RemoteAudio)];case 1:return[2,t.sent()]}}))}))},t.prototype.getRemoteVideoStats=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:if(!this._octopusClient)throw new Error("OctopusRTC is not a instance.");return[4,this._octopusClient.getMediaStreamTrackStats(e,h.type.RemoteVideo)];case 1:return[2,t.sent()]}}))}))},t.prototype.initRecord=function(e,t){var r=t.mimeType,n=t.codec;return this._record=new m.RecordMediastream(e,{codec:n,mimeType:r}),this._record},t.prototype.eventemitFunctions=function(){var e=this;this._octopusClient&&(this._octopusClient.on("@getpublishstate",(function(t){e.emit("publish-state-update",t)})),this._octopusClient.on("@getplaystate",(function(t){e.emit("play-state-update",t)})),this._octopusClient.on("@getstreamupdate",(function(t){e.emit("stream-update",t)})),this._octopusClient.on("@getdisconnect",(function(t){e.emit("disconnect",t)})),this._octopusClient.on("@getkickout",(function(t){e.emit("kick-out",t),e.logout()})))},t.prototype.setLogLevel=function(e){this._logger.setLogLevel(e)},t.prototype.enableLogUpload=function(){this._logger.enableLogUpload()},t.prototype.disableLogUpload=function(){this._logger.disableLogUpload()},t.prototype.devicesList=function(){return o(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return e=p.default.bind,[4,navigator.mediaDevices.enumerateDevices()];case 1:return[2,new(e.apply(p.default,[void 0,t.sent()]))]}}))}))},t.prototype.getCamerasList=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.devicesList()];case 1:return[2,e.sent().cameras]}}))}))},t.prototype.getMicrophonesList=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.devicesList()];case 1:return[2,e.sent().microphones]}}))}))},t.prototype.getSpeakersList=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.devicesList()];case 1:return[2,e.sent().speakers]}}))}))},t}(u.default);t.default=y},function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0;var o=r(4),s=r(3),a=function(){function e(e){this._logLevel=0,this._LOGLEVELARR=["debug","info","warn","error","report"],this._appId="",this._userId="",this._uploadMsgArr=[],this._reportTime=5e3,this._reportHandler=0,this.debug=null,this.info=null,this.warn=null,this.error=null,this.report=null,this._appId=e.appId,this._userId=e.userId,this.debug=this.proxyConsole.bind(this,"debug"),this.info=this.proxyConsole.bind(this,"info"),this.warn=this.proxyConsole.bind(this,"warn"),this.error=this.proxyConsole.bind(this,"error"),this.report=this.proxyConsole.bind(this,"report")}return e.prototype.setLogLevel=function(e){this._logLevel=e},e.prototype.enableLogUpload=function(){this.startIntervalUploadLog()},e.prototype.disableLogUpload=function(){this._reportHandler&&clearTimeout(this._reportHandler)},e.prototype.formatArgs=function(e,t){var r={time:e[0]};if("string"!=typeof e[1])throw new Error("lack of keyword.");var n=e[1],i=e[2];return i?"string"==typeof i?r[n]=i:"object"==typeof i&&(r[n]=i):r.msg=n,"report"==t&&this._uploadMsgArr.push(JSON.stringify(r)),r},e.prototype.startIntervalUploadLog=function(){var e=this;0!==this._uploadMsgArr.length&&s.uploadLog({appId:this._appId,userId:this._userId,message:this._uploadMsgArr}).then((function(t){if(0!==t.code)throw new Error("report log error.");e._uploadMsgArr=[]}),(function(e){throw new Error("report log error.")})),this._reportHandler=setTimeout(this.startIntervalUploadLog.bind(this),this._reportTime)},e.prototype.proxyConsole=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),t.unshift(this.dateFormat()),"development"==o.ENV&&this._LOGLEVELARR.push("log");var r=this._LOGLEVELARR.slice(this._logLevel);if(4==this._logLevel&&(r=["report","info"]),-1!=r.indexOf(e))switch(e){case"report":this.formatArgs(t,"report");break;case"log":console.log.apply(null,i([""],t));break;case"debug":console.info.call(null,JSON.stringify(this.formatArgs(t)));break;case"info":4==this._logLevel?this.formatArgs(t,"report"):console.info.call(null,"%c"+JSON.stringify(this.formatArgs(t,"report")),"color: #311078");break;case"warn":console.warn.apply(null,i([""],t));break;case"error":console.error.apply(null,i([""],t))}},e.prototype.dateFormat=function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+"."+e.getMilliseconds()},e}();t.Log=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.constantConfig=t.envConfig=void 0,t.envConfig={liveme:{prod:{CENTERURL:"https://rtc-stream-global-center.linkv.fun",LOGURL:"wss://rtc-fs.linkv.fun"},test:{CENTERURL:"https://qa-rtc-stream-global-center.linkv.fun",LOGURL:"wss://rtc-fs.linkv.fun"},dev:{CENTERURL:"https://qa-rtc-stream-global-center.linkv.fun",LOGURL:"wss://rtc-fs.linkv.fun"}},cm:{prod:{CENTERURL:"https://rtc-stream-cn-center.linkv.fun",LOGURL:"wss://rtc-fs.linkv.fun"},test:{CENTERURL:"https://qa-rtc-stream-cn-center.linkv.fun",LOGURL:"wss://rtc-fs.linkv.fun"},dev:{CENTERURL:"https://qa-rtc-stream-cn-center.linkv.fun",LOGURL:"wss://rtc-fs.linkv.fun"}}},t.constantConfig={LOGREPORT:"https://joyme-weblog.linkv.fun",STATSURL:"https://linkv-old-collect.linkv.fun"}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OctopusClientTest=void 0;var d=l(r(14)),f=l(r(15)),h=l(r(25)),p=r(1),m=l(r(2)),y=r(26),_=r(5),g=r(3),v=r(6),b=function(e){function t(t){var r=e.call(this)||this;return r._roomId="",r._role=1,r._appId="",r._userId="",r._signal=null,r._media=null,r._logger=null,r._mapStreamIdInfo=new Map,r._audioCustomBitrate=0,r._videoCustomBitrate=0,r._customFramerate=0,r._env="prod",r._projectName="liveme",r._customEdgeUrl="",r._reportHandle=0,r._mapStreamIdhandler=new Map,r._pullStreamList=new Map,r.reconnectionFun=function(e){var t=r._mapStreamIdInfo.get(e.streamId),n=r._mapStreamIdhandler.get(e.streamId);if(!t||!n)throw new Error("streamId is not exist.");n.destroy(),r._mapStreamIdhandler.delete(e.streamId),clearTimeout(r._reportHandle),e.userId==r._userId?r.startPublishingStream(e.streamId,t.mediastream):r.startPlayingStream(e.streamId)},r._appId=t.appId,r._userId=t.userId,void 0!==t&&(void 0!==t.customEdgeUrl&&(r._customEdgeUrl=t.customEdgeUrl),void 0!==t.env&&(r._env=t.env),void 0!==t.projectName&&(r._projectName=t.projectName)),r._logger=p.logger.collect,r}return i(t,e),t.prototype.login=function(e,t,r,n,i){return s(this,void 0,void 0,(function(){var o=this;return a(this,(function(s){return[2,new Promise((function(s,a){o._signal=new f.default({appPackageName:e,env:o._env,projectName:o._projectName,roomId:t,appId:o._appId,userId:o._userId,customEdgeUrl:o._customEdgeUrl}),o.getSignalState(),o._signal.init({auth:n,expire:i,role:r}),o._roomId=t,o._role=r,o._signal.on("@getjoinsucessresult",(function(e){200==e.code?s(e.msg):a(e)}))}))]}))}))},t.prototype.getSignalState=function(){var e=this;if(!this._signal)throw new Error("signal is not a instance.");this._signal.on("@kickout",(function(t){e.emit("@getkickout",t)})),this._signal.on("@disconnect",(function(t){e.emit("@getdisconnect",t)})),this._signal.on("@streamupdate",(function(t){e._logger.debug("streamupdate::::",t),e.emit("@getstreamupdate",t)}))},t.prototype.logout=function(){this._signal&&(clearTimeout(this._reportHandle),this.removeAllListeners(),this._signal.logout())},t.prototype.createStream=function(e){return s(this,void 0,void 0,(function(){var t,r,n,i,o,s,c;return a(this,(function(a){switch(a.label){case 0:if(t=e||{},r={audio:!0,video:!0},this._media||(this._media=new d.default({userId:this._userId})),!t.camera)return[3,2];if(n=t.camera,-1!=Object.keys(n).indexOf("audio")){if("boolean"!=typeof n.audio)throw new TypeError("audio must be boolean");r.audio=n.audio,n.audio&&(r.audio={},n.audioInput&&(r.audio.deviceId=n.audioInput),n.AGC&&(r.audio.autoGainControl=n.AGC),n.AEC&&(r.audio.echoCancellation=n.AEC),n.ANS&&(r.audio.noiseSuppression=n.ANS),n.sampleRate&&(r.audio.sampleRate=n.sampleRate),n.channelCount&&(r.audio.channelCount=n.channelCount),n.audioBitrate&&(this._audioCustomBitrate=n.audioBitrate),0===Object.keys(r.audio).length&&(r.audio=!0))}else r.audio=!0;if(-1!=Object.keys(n).indexOf("video")){if("boolean"!=typeof n.video)throw new TypeError("video must be boolean");r.video=n.video,n.video&&(r.video={},n.videoInput&&(r.video.deviceId=n.videoInput),n.facingMode&&(r.video.facingMode=n.facingMode),n.videoQuality&&(n.videoQuality<4?(i=h.default.camera.videoQuality[n.videoQuality-1],this._videoCustomBitrate=i.bitRate,r.video.width=i.width,r.video.height=i.height,r.video.frameRate=i.frameRate):(n.width&&(r.video.width=n.width),n.height&&(r.video.height=n.height),n.frameRate&&(r.video.frameRate=n.frameRate),n.bitrate&&(this._videoCustomBitrate=n.bitrate)),"number"==typeof r.video.frameRate&&(this._customFramerate=r.video.frameRate)),0===Object.keys(r.video).length&&(r.video=!0))}else r.video=!0;return[4,this._media.getLocalMediaStream("camera",r)];case 1:return[2,a.sent()];case 2:if(!t.screen)return[3,4];if(o=t.screen,s={audio:!1,video:!0},o.audio){if("boolean"!=typeof o.audio)throw new TypeError("audio must be boolean");s.audio=o.audio}return o.videoQuality&&(s.video={},o.videoQuality<4?(c=h.default.screen.videoQuality[o.videoQuality-1],this._videoCustomBitrate=c.bitRate,s.video.frameRate=c.frameRate):(o.frameRate&&(s.video.frameRate=o.frameRate),o.bitrate&&(this._videoCustomBitrate=o.bitrate)),"number"==typeof s.video.frameRate&&(this._customFramerate=s.video.frameRate)),[4,this._media.getLocalMediaStream("display",s)];case 3:return[2,a.sent()];case 4:return t.custom?[2,t.custom.source]:[3,5];case 5:return[4,this._media.getLocalMediaStream("camera",r)];case 6:return[2,a.sent()]}}))}))},t.prototype.destroyStream=function(e){if(!this._media)throw new Error("media is not a instance.");this._media.destroyLocalMediaStream(e)},t.prototype.getMediaStreamTrackConstrains=function(e){var t,r;try{for(var n=c(e.getTracks()),i=n.next();!i.done;i=n.next()){var o=i.value;if("video"==o.kind)try{var s=o.getSettings();g.uploadSensorsStats({app_id:this._appId,capture_height:s.height,capture_width:s.width,connect_state:-1,edge_url:"",encode_height:s.height,encode_width:s.width,event_type:3,fps:s.frameRate,is_host:1==this._role?1:0,join_room_cost:0,log_type:"liveme_video_rtc_room_event",min_bitrate:this._videoCustomBitrate,push_bitrate:this._videoCustomBitrate,room_id:this._roomId,self_user_id:this._userId})}catch(e){this._logger.debug("brower can not support getSettings")}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},t.prototype.startPublishingStream=function(e,t,r,n){return s(this,void 0,void 0,(function(){var r=this;return a(this,(function(n){return g.uploadSensorsStats({app_id:this._appId,event_type:4,log_type:"liveme_video_rtc_statistics",room_id:this._roomId,self_user_id:this._userId,user_id:this._userId}),this.getMediaStreamTrackConstrains(t),this._media||(this._media=new d.default({userId:this._userId})),this._mapStreamIdInfo.set(e,{mediastream:t}),this.transport(e,"send"),this.getStreamStateUpdate(e).then((function(t){g.uploadSensorsStats({app_id:r._appId,event_type:5,isConnected:t.code,log_type:"liveme_video_rtc_statistics",room_id:r._roomId,self_user_id:r._userId,user_id:r._userId}),t.streamId==e&&r.emit("@getpublishstate",t)}),(function(e){throw new Error(e)})),[2]}))}))},t.prototype.startPlayingStream=function(e,t,r){return s(this,void 0,void 0,(function(){var t,r,n,i,o,s,u,l,d,f,h,p,m,y,_,v,b=this;return a(this,(function(a){switch(a.label){case 0:return g.uploadSensorsStats({app_id:this._appId,event_type:6,log_type:"liveme_video_rtc_statistics",room_id:this._roomId,self_user_id:this._userId,user_id:e}),this.transport(e,"recv"),r=(t=this._pullStreamList).set,n=[e],[4,this._mapStreamIdhandler.get(e).getPlayStream()];case 1:if(r.apply(t,n.concat([a.sent()])),i=this._mapStreamIdInfo.get(e)){g.uploadSensorsStats({app_id:this._appId,event_type:7,isConnected:3,log_type:"liveme_video_rtc_statistics",room_id:this._roomId,self_user_id:this._userId,user_id:e}),o=i.mediastream;try{for(s=c(o.getTracks()),u=s.next();!u.done;u=s.next())(l=u.value).stop(),o.removeTrack(l)}catch(e){m={error:e}}finally{try{u&&!u.done&&(y=s.return)&&y.call(s)}finally{if(m)throw m.error}}try{for(d=c(this._pullStreamList.get(e).getTracks()),f=d.next();!f.done;f=d.next())h=f.value,o.addTrack(h)}catch(e){_={error:e}}finally{try{f&&!f.done&&(v=d.return)&&v.call(d)}finally{if(_)throw _.error}}this.emit("@getplaystate",{code:11,state:"REPLAYING",streamId:e})}else this._mapStreamIdInfo.set(e,{mediastream:this._pullStreamList.get(e)}),this.getStreamStateUpdate(e).then((function(t){g.uploadSensorsStats({app_id:b._appId,event_type:7,isConnected:t.code,log_type:"liveme_video_rtc_statistics",room_id:b._roomId,self_user_id:b._userId,user_id:e}),b.emit("@getplaystate",t)}),(function(e){throw new Error(e)}));if(!(p=this._mapStreamIdInfo.get(e)))throw new Error("streamId is not exist.");return[2,p.mediastream]}}))}))},t.prototype.transport=function(e,t){return s(this,void 0,void 0,(function(){var r,n,i,o,c,u=this;return a(this,(function(l){switch(l.label){case 0:if(!this._signal)throw new Error("signal is not a instance.");return this._mapStreamIdhandler.set(e,new y.Device),this._mapStreamIdhandler.get(e).load({streamId:e,direction:t}),"send"==t&&(this._videoCustomBitrate||this._audioCustomBitrate)&&this._mapStreamIdhandler.get(e).setUserCustomParams({videoCustomBitrate:this._videoCustomBitrate,audioCustomBitrate:this._audioCustomBitrate,customFramerate:this._customFramerate}),(n=this._mapStreamIdInfo.get(e))&&(i=n.mediastream,r={mediastream:i}),[4,this._mapStreamIdhandler.get(e).getLocalOfferSdp(r)];case 1:return o=l.sent().localOfferSdp,this._signal.sendLocalOfferSdp({sdp:o,pullStreamId:e,pullStreamRoomId:this._roomId}),this._signal.getCandidateArray(e),c=function(t){return s(u,void 0,void 0,(function(){var r,n;return a(this,(function(i){switch(i.label){case 0:if(!this._signal)throw new Error("signal not a instance.");return[4,this._signal.receiveAnswerSdp(e)];case 1:return r=i.sent(),this._logger.report("get answersdp",r),"remoteAnswerSdp"in r&&(n=r.remoteAnswerSdp,r.peerId,this._mapStreamIdhandler.get(e).setRemoteAnswerSdp({remoteAnswerSdp:n})),this._logger.report("get candidateResult",t),this._mapStreamIdhandler.get(e).setIceCandidate(t),[2]}}))}))},this._signal.on("@getcandidate"+e,(function(t){if(c(t),!u._signal)throw new Error("signal not a instance.");u._signal.off("@getcandidate"+e)})),[2]}}))}))},t.prototype.getStreamStateUpdate=function(e){return s(this,void 0,void 0,(function(){var t,r,n,i=this;return a(this,(function(o){switch(o.label){case 0:if(!this._signal)throw new Error("signal not a instance.");if(!(t=this._mapStreamIdhandler.get(e)))throw new Error("Device handler not load.");o.label=1;case 1:return o.trys.push([1,3,,4]),this._signal.off("@reconnection",this.reconnectionFun),[4,t.getConnectionStateUpdate()];case 2:return 1==(r=o.sent()).code&&(0==this._reportHandle&&setTimeout((function(){i.uploadRealtimeStreamData()}),1e3),this.reconnectionListeners()),[2,r];case 3:throw n=o.sent(),new Error(n);case 4:return[2]}}))}))},t.prototype.stopPublishingStream=function(e){var t=this._mapStreamIdhandler.get(e);if(!t)throw new Error("Device handler not load.");if(t.stopTransceiver(),t.destroy(),this._mapStreamIdhandler.delete(e),!this._media)throw new Error("media is not a instance");if(!this._signal)throw new Error("signal not a instance.");this._signal.stopPush(e),this._logger&&this._logger.info("stop publish stream success.")},t.prototype.stopPlayingStream=function(e){var t=this._mapStreamIdhandler.get(e);if(!t)throw new Error("Device handler not load.");if(t.stopTransceiver(),t.destroy(),this._mapStreamIdhandler.delete(e),!this._signal)throw new Error("signal is not a instance.");this._signal.stopPlay(e),this._logger&&this._logger.info("stop play stream success.")},t.prototype.updateMixStream=function(e,t,r){this._signal&&this._signal.updateMixStream(e)},t.prototype.muteSwitch=function(e,t){var r=this._mapStreamIdInfo.get(e);if(!r)throw new Error("streamId is not exist.");var n=r.mediastream;n.getAudioTracks()[0].enabled=!t},t.prototype.cameraSwitch=function(e,t){var r=this._mapStreamIdInfo.get(e);if(!r)throw new Error("streamId is not exist.");var n=r.mediastream;n.getVideoTracks()[0].enabled="open"==t},t.prototype.updateDevice=function(e,t,r,n){return s(this,void 0,void 0,(function(){var i,o,s;return a(this,(function(a){switch(a.label){case 0:"audio"==e?i={audio:{deviceId:{exact:r}}}:"video"==e&&(i={video:{deviceId:{exact:r}}}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(i)];case 2:return o=a.sent(),s="video"==e?o.getVideoTracks()[0]:o.getAudioTracks()[0],[2,this.replaceTrack(t,s,n)];case 3:return a.sent(),[2,_.errCode.get("devicesSupportError")];case 4:return[2]}}))}))},t.prototype.replaceTrack=function(e,t,r){if(r){var n=this._mapStreamIdhandler.get(r);n&&n.replaceTrack(t)}if(!this._media)throw new Error("media is not a instance");return this._media.replaceTrack(e,t)},t.prototype.changeConstraints=function(e,t,r,n){return s(this,void 0,void 0,(function(){var i,s,c;return a(this,(function(a){switch(a.label){case 0:return r.audioInput?[4,this.updateDevice(t,e,r.audioInput,n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return r.videoInput?[4,this.updateDevice(t,e,r.videoInput,n)]:[3,4];case 3:a.sent(),a.label=4;case 4:if(!e)return[2,o({},_.errCode.get("constrainChangeFailed"))];if("audio"!==t)return[3,9];a.label=5;case 5:return a.trys.push([5,7,,8]),[4,e.getAudioTracks()[0].applyConstraints(r)];case 6:return a.sent(),[3,8];case 7:throw i=a.sent(),new Error(i);case 8:return[3,13];case 9:if("video"!==t)return[3,13];s=r,r.videoQuality&&(s=o(o({},r),h.default.camera.videoQuality[r.videoQuality-1])),a.label=10;case 10:return a.trys.push([10,12,,13]),[4,e.getVideoTracks()[0].applyConstraints(s)];case 11:return a.sent(),[3,13];case 12:throw c=a.sent(),new Error(c);case 13:return[2,o({},_.errCode.get("constrainChangeSuccess"))]}}))}))},t.prototype.uploadRealtimeStreamData=function(){return s(this,void 0,void 0,(function(){var e,t,r,n,i,s,l,d,f,h;return a(this,(function(a){switch(a.label){case 0:e={crystalBall:[],sensorData:[]},a.label=1;case 1:a.trys.push([1,6,7,8]),t=c(this._mapStreamIdhandler),r=t.next(),a.label=2;case 2:if(r.done)return[3,5];if(n=u(r.value,2),i=n[0],!(s=n[1]))throw new Error("streamId is not exist.");return[4,s.getStatsData(v.type.Sensor)];case 3:null!=(l=a.sent()).crystalBall&&(e.crystalBall.push(o({room_id:this._roomId,user_id:i},l.crystalBall)),e.sensorData.push(o({room_id:this._roomId,self_user_id:this._userId,stream_user_id:i},l.sensor))),a.label=4;case 4:return r=t.next(),[3,2];case 5:return[3,8];case 6:return d=a.sent(),f={error:d},[3,8];case 7:try{r&&!r.done&&(h=t.return)&&h.call(t)}finally{if(f)throw f.error}return[7];case 8:if(!this._signal)throw new Error("signal not a instance.");return 0!==e.crystalBall.length&&(this._signal.uploadStatsData(e),e={crystalBall:[],sensorData:[]}),this._reportHandle=setTimeout(this.uploadRealtimeStreamData.bind(this),5e3),[2]}}))}))},t.prototype.reconnectionListeners=function(){if(!this._signal)throw new Error("signal not a instance.");this._signal.on("@reconnection",this.reconnectionFun)},t.prototype.getMediaStreamTrackStats=function(e,t){return s(this,void 0,void 0,(function(){var r;return a(this,(function(n){switch(n.label){case 0:if(!(r=this._mapStreamIdhandler.get(e)))throw new Error("streamId is not exist.");return[4,r.getStatsData(t)];case 1:return[2,n.sent()]}}))}))},t}(m.default);t.OctopusClientTest=b},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var s,a=r(1);!function(e){e.MICROPHONE="audioinput",e.SPEAKER="audiooutput",e.CAMERA="videoinput"}(s||(s={}));var c=function(){function e(e){this._currentStream={},this._userId="",this._mapStreamIdMediastream=new Map,this._logger=null,this._userId=e.userId,this._logger=a.logger.collect}return e.enumerateDevices=function(e,t){return n(this,void 0,void 0,(function(){var r,n,a,c,u,l,d,f,h,p;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,navigator.mediaDevices.enumerateDevices()];case 1:r=i.sent(),n=[],a=[],c=[];try{for(u=o(r),l=u.next();!l.done;l=u.next())switch((d=l.value).kind){case s.MICROPHONE:n.push(d);break;case s.SPEAKER:a.push(d);break;case s.CAMERA:c.push(d)}}catch(e){h={error:e}}finally{try{l&&!l.done&&(p=u.return)&&p.call(u)}finally{if(h)throw h.error}}return"function"==typeof e&&e({microphones:n,speakers:a,cameras:c}),[2,Promise.resolve({microphones:n,speakers:a,cameras:c})];case 2:return f=i.sent(),"function"==typeof t&&t(f),[2,Promise.reject(f)];case 3:return[2]}}))}))},e.prototype.getLocalMediaStream=function(e,t){return n(this,void 0,void 0,(function(){var r,n,s,a,c,u,l,d,f,h,p,m;return i(this,(function(i){switch(i.label){case 0:this._logger.debug("local mediastream constraints",t),i.label=1;case 1:return i.trys.push([1,7,,11]),"display"!=e?[3,4]:[4,navigator.mediaDevices.getDisplayMedia(t)];case 2:return r=i.sent(),[4,navigator.mediaDevices.getUserMedia({audio:!0})];case 3:n=i.sent(),s=n.getAudioTracks()[0],t&&!t.audio&&(s.enabled=!1);try{for(a=o(r.getTracks()),c=a.next();!c.done;c=a.next())u=c.value,this._logger.report("displayStream has audio track",u),"audio"==u.kind&&(u.stop(),r.removeTrack(u))}catch(e){p={error:e}}finally{try{c&&!c.done&&(m=a.return)&&m.call(a)}finally{if(p)throw p.error}}return r.addTrack(s),[2,Promise.resolve(r)];case 4:return d=(l=Promise).resolve,[4,navigator.mediaDevices.getUserMedia(t)];case 5:return[2,d.apply(l,[i.sent()])];case 6:return[3,11];case 7:return(f=i.sent()).constraint&&"camera"==e?(this._logger.report("getUserMedia error",f),[4,navigator.mediaDevices.getUserMedia({audio:!0,video:!0})]):[3,9];case 8:return h=i.sent(),[2,Promise.resolve(h)];case 9:return[2,Promise.reject(f)];case 10:return[3,11];case 11:return[2]}}))}))},e.prototype.destroyLocalMediaStream=function(e){var t,r;try{for(var n=o(e.getTracks()),i=n.next();!i.done;i=n.next()){var s=i.value;s.stop(),e.removeTrack(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.replaceTrack=function(e,t){var r,n;try{for(var i=o(e.getTracks()),s=i.next();!s.done;s=i.next()){var a=s.value;a.kind==t.kind&&(a.stop(),e.removeTrack(a))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return e.addTrack(t),e},e.prototype.enumerateDevices=function(t,r){return n(this,void 0,void 0,(function(){return i(this,(function(n){return[2,e.enumerateDevices(t,r)]}))}))},e}();t.default=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t}(o(r(16)).default);t.default=s},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},l=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=d(r(17)),h=r(5),p=r(24),m=r(3),y=function(e){function t(t){var r=e.call(this,t)||this;return r._timer=null,r._timeouter=null,r.signalTimeout=90,r._initJoinRoomParams=null,r._isKick=!1,r._succeed=!1,r._roomOnlineList=[],r._offerPeerId=0,r._connectState=0,r._role=0,r._joinRoomStartTime=0,r._portCandidateObj={},r._MapStreamIdCandidatePort=new Map,r._MapStreamIdAnswerSdp=new Map,r._iceConnectionStreamIdMap=new Map,r._isExecAnswersdp=new Map,r.onJoinSuccess=function(e){var t,n,i,o;if(r._logger.info("receive joinSuccess msg",e),m.uploadSensorsStats({app_id:r._appId,code:e.code,event_type:13,is_host:1==r._role?1:0,log_type:"liveme_video_rtc_statistics",room_id:r._roomId,self_user_id:r._userId}),!e||500==e.code)return r.leaveRoom(),void r.emit("@disconnect",h.errCode.get("wsDisconnect"));if(200!==e.code)r.resetSignalState("joinSuccess");else{var s=p.formatKeyToHump(e);m.uploadSensorsStats({app_id:r._appId,connect_state:s.connectState,edge_url:r._currentEdgeUrl,event_type:1,is_host:1==r._role?1:0,join_room_cost:(new Date).getTime()-r._joinRoomStartTime,log_type:"liveme_video_rtc_room_event",room_id:r._roomId,self_user_id:r._userId}),r._succeed=!0;var a=s.connectState;if(1==a)return;s.participants&&0!==s.participants.length?r._roomOnlineList=s.participants:r.emit("@getjoinsucessresult",{code:200,msg:[]});var l=[],d=[];try{for(var f=c(r._roomOnlineList),y=f.next();!y.done;y=f.next()){var _=y.value;d.push(_.userId),_.userId!=r._userId&&l.push({streamId:_.userId,userId:_.userId,roomId:_.roomId}),_.userId===r._userId||r._iceConnectionStreamIdMap.get(_.userId)||2!=a&&3!=a||r.emit("@streamupdate",{code:1,streamList:[_]})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}if(2==a||3==a)try{for(var g=c(r._iceConnectionStreamIdMap),v=g.next();!v.done;v=g.next()){var b=u(v.value,2),w=b[0];b[1];w!==r._userId&&-1==d.indexOf(w)?r.emit("@streamupdate",{code:0,streamList:[{streamId:w,userId:w,roomId:r._roomId}]}):r.reconnection(w)}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}r.emit("@getjoinsucessresult",{code:200,msg:l}),r._logger.info("login result",l)}},r.onAddParticipants=function(e){var t,n,i=p.formatKeyToHump(e),o=[];i.participants.forEach((function(e,t){e.streamId=e.userId,o.push(e)}));var s=r._roomOnlineList.concat(o),a={};try{for(var u=c(s),l=u.next();!l.done;l=u.next()){var d=l.value;a[d.userId]=d}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}for(var f in r._roomOnlineList=[],a)r._roomOnlineList.push(a[f]);r.emit("@streamupdate",{code:1,streamList:o}),i=null,r._logger.report("addparticipant message:",o)},r.onUpdateParticipant=function(e){var t=p.formatKeyToHump(e);r._logger.report("updateparticipant message:",t),r._isExecAnswersdp.delete(t.userId),r.reconnection(t.userId),t=null},r.onRemoveParticipant=function(e){var t=p.formatKeyToHump(e);r._logger.report("removeparticipant message:",t),r.emit("@streamupdate",{code:0,streamList:[{userId:t.userId,streamId:t.userId,roomId:t.roomId}]}),t=null},r.onKickParticipant=function(e){r._isKick=!0;var t=p.formatKeyToHump(e);r._logger.report("updateparticipant message:",t),r.emit("@kickout",t),t=null},r}return i(t,e),t.prototype.init=function(e){return s(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return this._initJoinRoomParams=e,[4,this.connect({auth:e.auth,expire:e.expire})];case 1:return t.sent(),this.wsEvents(),[2]}}))}))},t.prototype.logout=function(){clearTimeout(this._timer),clearTimeout(this._timeouter),this.leaveRoom()},t.prototype.getNewEdgeList=function(){return s(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,m.getEdgeList({appId:this._appId,roomId:this._roomId,userId:this._userId,env:this._env,projectName:this._projectName})];case 1:return e=t.sent(),this._edgeUrls=Array.from(new Set(l(this._edgeUrls,e))),[2]}}))}))},t.prototype.errorFun=function(e){switch(e){case"joinSuccess":this.emit("@getjoinsucessresult",{code:400,msg:h.errCode.get("wsDisconnect")})}},t.prototype.signalReconnect=function(e){var t=this;this._timeouter||(this._timeouter=setTimeout((function(){clearTimeout(t._timer),clearTimeout(t._timeouter),e?t.errorFun(e):t.changeVendor()}),1e3*this.signalTimeout)),this.leaveRoom(),this._timer=setTimeout((function(){var e=Math.ceil(t.signalTimeout/8);t._edgeUrls.length<e&&t.getNewEdgeList(),t._retryTimes>=t._maxRetryTimes?(t._retryTimes=0,t._edgeUrls.length>1&&t._edgeListIndex++,t._currentEdgeUrl=t._edgeUrls[t._edgeListIndex],t._initJoinRoomParams&&t.init(t._initJoinRoomParams),t._succeed&&(t._connectState=2),t._edgeUrls.length>1&&t._edgeListIndex+1>=t._edgeUrls.length&&(t._edgeListIndex=-1)):t._retryTimes<t._maxRetryTimes&&(t._initJoinRoomParams&&t.init(t._initJoinRoomParams),t._succeed&&(t._connectState=1),t._retryTimes++)}),2e3)},t.prototype.resetSignalState=function(e){clearTimeout(this._timer),this.signalReconnect(e)},t.prototype.sendMessage=function(e,t){var r=p.formatAppId(t,this._appId);this._ws&&this._ws.emit(e,r),r=null},t.prototype.wsEvents=function(){var e=this;if(!this._ws)throw new Error("websocket connect failed.");this._ws.on("connect",(function(){e._logger.info("signal connect success."),e._retryTimes=0,clearTimeout(e._timer),clearTimeout(e._timeouter),e.onConnect()})),this._ws.on("connect_error",(function(t){e._logger.warn("signal connect_error",t),e.resetSignalState()})),this._ws.on("connect_timeout",(function(t){e._logger.warn("signal connect_timeout",t),e.resetSignalState()})),this._ws.on("error",(function(t){e._logger.warn("signal error",t),e.resetSignalState()})),this._ws.on("disconnect",(function(t){if(e._logger.debug("disconnect reason",t),"io client disconnect"===t)return clearTimeout(e._timer),void clearTimeout(e._timeouter);e._logger.info("signal disconnect",t),e.resetSignalState()})),this._ws.on("close",(function(){e._logger.debug("signal status: close")})),this._ws.on("joinSuccess",this.onJoinSuccess),this._ws.on("addParticipants",this.onAddParticipants),this._ws.on("updateParticipant",this.onUpdateParticipant),this._ws.on("removeParticipant",this.onRemoveParticipant),this._ws.on("kick",this.onKickParticipant)},t.prototype.onConnect=function(){return s(this,void 0,void 0,(function(){var e;return a(this,(function(t){if(!this._initJoinRoomParams)throw new Error("lack of joinroom params.");switch(this._iceConnectionStreamIdMap.size){case 0:this._syncRole=0;break;case 1:this._iceConnectionStreamIdMap.get(this._userId)?this._syncRole=2:this._syncRole=1;break;default:this._iceConnectionStreamIdMap.get(this._userId)?this._syncRole=3:this._syncRole=1}return e={c_stream_id:""+(new Date).getTime(),app_id:this._appId,connect_state:this._connectState,room_id:this._roomId,user_id:this._userId,host:1==this._initJoinRoomParams.role?1:0,role:2==this._initJoinRoomParams.role?"viewer_cdn":"participant",show:"all",user_source:m.getUserSource(),timestamp:(new Date).getTime(),sdk_version:m.numberVersion(),sync_role:this._syncRole,app_package_name:this._appPackageName},this._role=this._initJoinRoomParams.role,m.uploadSensorsStats({app_id:this._appId,room_id:this._roomId,self_user_id:this._userId,connect_state:this._connectState,edge_url:this._currentEdgeUrl,event_type:0,is_host:1==this._initJoinRoomParams.role?1:0,join_room_cost:0,log_type:"liveme_video_rtc_room_event"}),this._joinRoomStartTime=(new Date).getTime(),this.sendMessage("joinRoom",e),this._logger.info("send joinRoom msg",e),[2]}))}))},t.prototype.updateMixStream=function(e){var t,r,n=[],i={auto_mix:0,layout:n,mix_push_urls:[e.outputUrl],room_id:this._roomId,timestamp:(new Date).getTime(),user_id:this._userId};n.push({layout_params:{bitrate:e.outputBitrate,canvas_color:e.outputBgColor,canvas_height:e.outputHeight,canvas_image:e.outputBgImage,canvas_width:e.outputWidth,fps:e.outputFps},session_id:"canvas"});var o=1;try{for(var s=c(e.streamList),a=s.next();!a.done;a=s.next()){var u=a.value;u.roomId=this._appId+"-"+u.roomId,u.streamId=this._appId+"-"+u.streamId,n.push({layout_params:{image_height:u.bottom-u.top,image_layer:o++,image_width:u.right-u.left,location_x:u.left,location_y:u.top},room_id:u.roomId?u.roomId:this._roomId,user_id:u.streamId})}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}this.sendMessage("mixStream",i)},t.prototype.stopMixStream=function(){this.sendMessage("mixStream",{room_id:this._roomId,timestamp:(new Date).getTime(),user_id:this._userId})},t.prototype.leaveRoom=function(){this._ws?(this._isExecAnswersdp.clear(),this._portCandidateObj={},this._isKick||this.sendMessage("leaveRoom",{room_id:this._roomId}),this.removeAllListeners("@disconnect"),this.removeAllListeners("@getjoinsucessresult"),this._ws.close(),this._ws=null):this._logger.debug("websocket taskId is not exist.")},t.prototype.stopPush=function(e){this._isExecAnswersdp.delete(e),this.sendMessage("stopBeam",{room_id:this._roomId,user_id:this._userId,timestamp:(new Date).getTime()})},t.prototype.stopPlay=function(e){this._isExecAnswersdp.delete(e),this.sendMessage("stop_play",{room_id:this._roomId,user_id:this._userId,timestamp:(new Date).getTime(),play_user_id:e})},t.prototype.reconnection=function(e){this._logger.debug("reconnection",e),this.emit("@reconnection",{streamId:e,userId:e})},t.prototype.sendLocalOfferSdp=function(e){var t=e.pullStreamId,r=e.pullStreamRoomId,n=e.sdp;this._offerPeerId+=1,this._iceConnectionStreamIdMap.set(t,{offerPeerId:this._offerPeerId});var i={peer_id:this._offerPeerId,offer_user_id:t,offer_room_id:r,sdp_offer:n,timestamp:(new Date).getTime(),room_id:this._roomId,user_id:this._userId,sdk_version:m.numberVersion()};return m.uploadSensorsStats({app_id:this._appId,event_type:8,log_type:"liveme_video_rtc_statistics",room_id:this._roomId,self_user_id:this._userId,user_id:t}),this.sendMessage("offerSDP",i),this._logger.report("send msg offerSDp",i),this._offerPeerId},t.prototype.getCandidateArray=function(e){var t=this;if(!this._ws)throw new Error("ws is not exist.");this._ws.on("iceCandidate",(function(r){var n=p.formatKeyToHump(r),i=n.candidate.candidate.split(" ").slice(-3,-2)[0];if(t._MapStreamIdCandidatePort.set(n.userId,i),t._portCandidateObj[i]){if(2==t._portCandidateObj[i].length)return;var o=!1;t._portCandidateObj[i].forEach((function(e,t,r){e.sdpMLineIndex==n.candidate.sdpMLineIndex&&(o=!0)})),o||t._portCandidateObj[i].push(n.candidate)}else t._portCandidateObj[i]=[],t._portCandidateObj[i].push(n.candidate);if(n.userId==e){var s=t._portCandidateObj[t._MapStreamIdCandidatePort.get(e)];t.emit("@getcandidate"+e,s)}n=null}))},t.prototype.receiveAnswerSdp=function(e){var t=this;return new Promise((function(r,n){if(!t._ws)throw new Error("ws is not exist.");var i=function(n){if(t._isExecAnswersdp.get(e))return r({code:2,msg:"Repeated execute"}),void t._ws.off("answerSDP",i);t._isExecAnswersdp.set(e,!0);var o=p.formatKeyToHump(n);m.uploadSensorsStats({app_id:t._appId,event_type:9,isSuccess:200==n.code?1:0,log_type:"liveme_video_rtc_statistics",room_id:t._roomId,self_user_id:t._userId,user_id:e});var s=t._iceConnectionStreamIdMap.get(o.userId);if(!s)throw new Error("answersp streamId is not exist.");o.peerId==s.offerPeerId?(200!=o.code?r({code:0,msg:"answsdp error"}):(t._MapStreamIdAnswerSdp.set(o.userId,o.sdpAnswer),e==o.userId&&t._MapStreamIdAnswerSdp.get(o.userId)&&r({peerId:o.peerId,remoteAnswerSdp:t._MapStreamIdAnswerSdp.get(o.userId)}),t._ws.off("answerSDP",i)),o=null):r({code:0,msg:"peerId repeat"})};t._ws.on("answerSDP",i)}))},t.prototype.uploadStatsData=function(e){var t=e.crystalBall;e.sensorData.forEach((function(e){m.uploadSensorsStats(o(o({},e),{log_type:"liveme_video_rtc_stream_heartbeat"}))})),this.sendMessage("clientstatistics",{room_id:this._roomId,sdk_version:101e4,user_id:this._userId,timestamp:(new Date).getTime(),statistics:t})},t}(f.default);t.default=y},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(r(18)),u=r(3),l=a(r(2)),d=r(5),f=r(1),h=function(e){function t(t){var r=e.call(this)||this;return r._customEdgeUrl="",r._logger=null,r._retryTimes=0,r._maxRetryTimes=3,r._edgeListIndex=0,r._roomId="",r._userId="",r._appId="",r._currentEdgeUrl="",r._edgeUrls=[],r._ws=null,r._syncRole=0,r._env="prod",r._projectName="liveme",r._appPackageName="",r._logger=f.logger.collect,r._logger.debug("signal constructor params",t),r._userId=t.userId,r._roomId=t.roomId,void 0!==t.appId&&(r._appId=t.appId),void 0!==t.projectName&&(r._projectName=t.projectName),void 0!==t.env&&(r._env=t.env),void 0!==t.customEdgeUrl&&(r._customEdgeUrl=t.customEdgeUrl),void 0!==t.appPackageName&&(r._appPackageName=t.appPackageName),r}return i(t,e),t.prototype.connect=function(e){e.auth,e.expire;return o(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return this._currentEdgeUrl?[3,3]:this._customEdgeUrl?(this._currentEdgeUrl="wss://"+this._customEdgeUrl+"/octopus",[3,3]):[3,1];case 1:return e=this,[4,u.getEdgeList({appId:this._appId,roomId:this._roomId,userId:this._userId,env:this._env,projectName:this._projectName})];case 2:if(e._edgeUrls=t.sent(),this._logger.debug("current edge list",this._edgeUrls),!this._edgeUrls||0===this._edgeUrls.length)return this._logger.error("edgelist is null"),this.emit("@disconnect",d.errCode.get("nullEdgeList")),[2];this._currentEdgeUrl=this._edgeUrls[this._edgeListIndex],this.getIntervalEdgeUrls(),t.label=3;case 3:return this._ws=c.default(this._currentEdgeUrl,{transports:["websocket"]}),this._logger.debug("current websocket connect edge",this._currentEdgeUrl),this._ws.connect(),[2]}}))}))},t.prototype.getIntervalEdgeUrls=function(){var e=this;setInterval((function(){return o(e,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return e=this,[4,u.getEdgeList({appId:this._appId,roomId:this._roomId,userId:this._userId,env:this._env,projectName:this._projectName})];case 1:return e._edgeUrls=t.sent(),this._logger.debug("edgelist update",this._edgeUrls),[2]}}))}))}),36e5)},t.prototype.changeVendor=function(){this.emit("@disconnect",d.errCode.get("wsDisconnect"))},t}(l.default);t.default=h},function(e,t,r){(function(t){e.exports=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e,t){"object"===(void 0===e?"undefined":i(e))&&(t=e,e=void 0),t=t||{};var r,n=o(e),s=n.source,u=n.id,l=n.path,d=c[u]&&l in c[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?r=a(s,t):(c[u]||(c[u]=a(s,t)),r=c[u]),n.query&&!t.query&&(t.query=n.query),r.socket(n.path,t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(1),s=r(4),a=r(9);r(3)("socket.io-client"),e.exports=t=n;var c=t.managers={};t.protocol=s.protocol,t.connect=n,t.Manager=r(9),t.Socket=r(33)},function(e,t,r){"use strict";var n=r(2);r(3)("socket.io-client:url"),e.exports=function(e,t){var r=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==t?t.protocol+"//"+e:"https://"+e),r=n(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port,r.href=r.protocol+"://"+i+(t&&t.port===r.port?"":":"+r.port),r}},function(e,t){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var s=r.exec(e||""),a={},c=14;c--;)a[n[c]]=s[c]||"";return-1!=i&&-1!=o&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(e,t){"use strict";e.exports=function(){return function(){}}},function(e,t,r){function n(){}function i(e){var r=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(r+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(r+=e.nsp+","),null!=e.id&&(r+=e.id),null!=e.data){var n=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===n)return h;r+=n}return r}function o(){this.reconstructor=null}function s(e){var r=0,n={type:Number(e.charAt(0))};if(null==t.types[n.type])return c("unknown packet type "+n.type);if(t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type){for(var i="";"-"!==e.charAt(++r)&&(i+=e.charAt(r),r!=e.length););if(i!=Number(i)||"-"!==e.charAt(r))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(r+1))for(n.nsp="";++r&&","!==(s=e.charAt(r))&&(n.nsp+=s,r!==e.length););else n.nsp="/";var o=e.charAt(r+1);if(""!==o&&Number(o)==o){for(n.id="";++r;){var s;if(null==(s=e.charAt(r))||Number(s)!=s){--r;break}if(n.id+=e.charAt(r),r===e.length)break}n.id=Number(n.id)}if(e.charAt(++r)){var a=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(r));if(!1===a||n.type!==t.ERROR&&!d(a))return c("invalid payload");n.data=a}return n}function a(e){this.reconPack=e,this.buffers=[]}function c(e){return{type:t.ERROR,data:"parser error: "+e}}var u=(r(3)("socket.io-parser"),r(5)),l=r(6),d=r(7),f=r(8);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=n,t.Decoder=o;var h=t.ERROR+'"encode error"';n.prototype.encode=function(e,r){t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){l.removeBlobs(e,(function(e){var r=l.deconstructPacket(e),n=i(r.packet),o=r.buffers;o.unshift(n),t(o)}))}(e,r):r([i(e)])},u(o.prototype),o.prototype.add=function(e){var r;if("string"==typeof e)r=s(e),t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type?(this.reconstructor=new a(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!f(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(r=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",r))}},o.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},a.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=l.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},a.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,r){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n,i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r)for(var n=0,i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,r){var n=r(7),i=r(8),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);t.deconstructPacket=function(e){var t=[],r=e.data,o=e;return o.data=function e(t,r){if(!t)return t;if(i(t)){var o={_placeholder:!0,num:r.length};return r.push(t),o}if(n(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a],r);return s}if("object"==typeof t&&!(t instanceof Date)){for(var c in s={},t)s[c]=e(t[c],r);return s}return t}(r,t),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,r){if(!t)return t;if(t&&t._placeholder)return r[t.num];if(n(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],r);else if("object"==typeof t)for(var o in t)t[o]=e(t[o],r);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var r=0,o=e;(function e(c,u,l){if(!c)return c;if(s&&c instanceof Blob||a&&c instanceof File){r++;var d=new FileReader;d.onload=function(){l?l[u]=this.result:o=this.result,--r||t(o)},d.readAsArrayBuffer(c)}else if(n(c))for(var f=0;f<c.length;f++)e(c[f],f,c);else if("object"==typeof c&&!i(c))for(var h in c)e(c[h],h,c)})(o),r||t(o)}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,r){e.exports=function(e){return n&&t.isBuffer(e)||i&&(e instanceof ArrayBuffer||o(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,i="function"==typeof ArrayBuffer,o=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,r){"use strict";function n(e,t){if(!(this instanceof n))return new n(e,t);e&&"object"===(void 0===e?"undefined":i(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=t.parser||c;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(10),s=r(33),a=r(5),c=r(4),u=r(35),l=r(36),d=(r(3)("socket.io-client:manager"),r(32)),f=r(37),h=Object.prototype.hasOwnProperty;e.exports=n,n.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},n.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},n.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},a(n.prototype),n.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},n.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},n.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(e,t){if(~this.readyState.indexOf("open"))return this;this.engine=o(this.uri,this.opts);var r=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var i=u(r,"open",(function(){n.onopen(),e&&e()})),s=u(r,"error",(function(t){if(n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()}));if(!1!==this._timeout){var a=this._timeout,c=setTimeout((function(){i.destroy(),r.close(),r.emit("error","timeout"),n.emitAll("connect_timeout",a)}),a);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(i),this.subs.push(s),this},n.prototype.onopen=function(){this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(u(e,"data",l(this,"ondata"))),this.subs.push(u(e,"ping",l(this,"onping"))),this.subs.push(u(e,"pong",l(this,"onpong"))),this.subs.push(u(e,"error",l(this,"onerror"))),this.subs.push(u(e,"close",l(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",l(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(e){this.decoder.add(e)},n.prototype.ondecoded=function(e){this.emit("packet",e)},n.prototype.onerror=function(e){this.emitAll("error",e)},n.prototype.socket=function(e,t){function r(){~d(i.connecting,n)||i.connecting.push(n)}var n=this.nsps[e];if(!n){n=new s(this,e,t),this.nsps[e]=n;var i=this;n.on("connecting",r),n.on("connect",(function(){n.id=i.generateId(e)})),this.autoConnect&&r()}return n},n.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},n.prototype.packet=function(e){var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(r){for(var n=0;n<r.length;n++)t.engine.write(r[n],e.options);t.encoding=!1,t.processPacketQueue()})))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},n.prototype.cleanup=function(){for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(e){this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();this.reconnecting=!0;var r=setTimeout((function(){e.skipReconnect||(e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):e.onreconnect()})))}),t);this.subs.push({destroy:function(){clearTimeout(r)}})}},n.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,r){e.exports=r(11),e.exports.parser=r(18)},function(e,t,r){function n(e,t){return this instanceof n?(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new n(e,t)}var i=r(12),o=r(5),s=(r(3)("engine.io-client:socket"),r(32)),a=r(18),c=r(2),u=r(26);e.exports=n,n.priorWebsocketSuccess=!1,o(n.prototype),n.protocol=a.protocol,n.Socket=n,n.Transport=r(17),n.transports=r(12),n.parser=r(18),n.prototype.createTransport=function(e){var t=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var r=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new i[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,withCredentials:r.withCredentials||this.withCredentials,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative})},n.prototype.open=function(){var e;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},n.prototype.setTransport=function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},n.prototype.probe=function(e){function t(){if(d.onlyBinaryUpgrades){var e=!this.supportsBinary&&d.transport.supportsBinary;l=l||e}l||(u.send([{type:"ping",data:"probe"}]),u.once("packet",(function(e){if(!l)if("pong"===e.type&&"probe"===e.data){if(d.upgrading=!0,d.emit("upgrading",u),!u)return;n.priorWebsocketSuccess="websocket"===u.name,d.transport.pause((function(){l||"closed"!==d.readyState&&(c(),d.setTransport(u),u.send([{type:"upgrade"}]),d.emit("upgrade",u),u=null,d.upgrading=!1,d.flush())}))}else{var t=new Error("probe error");t.transport=u.name,d.emit("upgradeError",t)}})))}function r(){l||(l=!0,c(),u.close(),u=null)}function i(e){var t=new Error("probe error: "+e);t.transport=u.name,r(),d.emit("upgradeError",t)}function o(){i("transport closed")}function s(){i("socket closed")}function a(e){u&&e.name!==u.name&&r()}function c(){u.removeListener("open",t),u.removeListener("error",i),u.removeListener("close",o),d.removeListener("close",s),d.removeListener("upgrading",a)}var u=this.createTransport(e,{probe:1}),l=!1,d=this;n.priorWebsocketSuccess=!1,u.once("open",t),u.once("error",i),u.once("close",o),this.once("close",s),this.once("upgrading",a),u.open()},n.prototype.onOpen=function(){if(this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])},n.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}},n.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},n.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},n.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this},n.prototype.sendPacket=function(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var i={type:e,data:t,options:r};this.emit("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}},n.prototype.close=function(){function e(){n.onClose("forced close"),n.transport.close()}function t(){n.removeListener("upgrade",t),n.removeListener("upgradeError",t),e()}function r(){n.once("upgrade",t),n.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():e()})):this.upgrading?r():e()}return this},n.prototype.onError=function(e){n.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},n.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},n.prototype.filterUpgrades=function(e){for(var t=[],r=0,n=e.length;r<n;r++)~s(this.transports,e[r])&&t.push(e[r]);return t}},function(e,t,r){var n=r(13),i=r(15),o=r(29),s=r(30);t.polling=function(e){var t=!1,r=!1,s=!1!==e.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,c=location.port;c||(c=a?443:80),t=e.hostname!==location.hostname||c!==e.port,r=e.secure!==a}if(e.xdomain=t,e.xscheme=r,"open"in new n(e)&&!e.forceJSONP)return new i(e);if(!s)throw new Error("JSONP disabled");return new o(e)},t.websocket=s},function(e,t,r){var n=r(14);e.exports=function(e){var t=e.xdomain,r=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||n))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!r&&i)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,r){function n(){}function i(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,r=location.port;r||(r=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function s(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var a=r(13),c=r(16),u=r(5),l=r(27);if(r(3)("engine.io-client:polling-xhr"),e.exports=i,e.exports.Request=o,l(i,c),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new o(e)},i.prototype.doWrite=function(e,t){var r="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:r}),i=this;n.on("success",t),n.on("error",(function(e){i.onError("xhr post error",e)})),this.sendXhr=n},i.prototype.doPoll=function(){var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},u(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new a(e),r=this;try{t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var n in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(n)&&t.setRequestHeader(n,this.extraHeaders[n])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(r.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout((function(){r.onError("number"==typeof t.status?t.status:0)}),0))},t.send(this.data)}catch(e){return void setTimeout((function(){r.onError(e)}),0)}"undefined"!=typeof document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",s);else if("function"==typeof addEventListener){var d="onpagehide"in self?"pagehide":"unload";addEventListener(d,s,!1)}},function(e,t,r){function n(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=r(17),o=r(26),s=r(18),a=r(27),c=r(28);r(3)("engine.io-client:polling"),e.exports=n;var u=null!=new(r(13))({xdomain:!1}).responseType;a(n,i),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(e){function t(){r.readyState="paused",e()}var r=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(n++,this.once("pollComplete",(function(){--n||t()}))),this.writable||(n++,this.once("drain",(function(){--n||t()})))}else t()},n.prototype.poll=function(){this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(e){var t=this;s.decodePayload(e,this.socket.binaryType,(function(e,r,n){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())},n.prototype.doClose=function(){function e(){t.write([{type:"close"}])}var t=this;"open"===this.readyState?e():this.once("open",e)},n.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};s.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,r)}))},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(r=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e}},function(e,t,r){function n(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var i=r(18),o=r(5);e.exports=n,o(n.prototype),n.prototype.onError=function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,this.emit("error",r),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},n.prototype.onPacket=function(e){this.emit("packet",e)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,r){function n(e,r){return r("b"+t.packets[e.type]+e.data.data)}function i(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var i=e.data,o=new Uint8Array(i),s=new Uint8Array(1+i.byteLength);s[0]=y[e.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return n(s.buffer)}function o(e,r,n){if(!r)return t.encodeBase64Packet(e,n);if(m)return function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var i=new FileReader;return i.onload=function(){t.encodePacket({type:e.type,data:i.result},r,!0,n)},i.readAsArrayBuffer(e.data)}(e,r,n);var i=new Uint8Array(1);return i[0]=y[e.type],n(new v([i.buffer,e.data]))}function s(e,t,r){for(var n=new Array(e.length),i=d(e.length,r),o=function(e,r,i){t(r,(function(t,r){n[e]=r,i(t,n)}))},s=0;s<e.length;s++)o(s,e[s],i)}var a,c=r(19),u=r(20),l=r(21),d=r(22),f=r(23);"undefined"!=typeof ArrayBuffer&&(a=r(24));var h="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),p="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),m=h||p;t.protocol=3;var y=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},_=c(y),g={type:"error",data:"parser error"},v=r(25);t.encodePacket=function(e,t,r,s){"function"==typeof t&&(s=t,t=!1),"function"==typeof r&&(s=r,r=null);var a=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer)return i(e,t,s);if(void 0!==v&&a instanceof v)return o(e,t,s);if(a&&a.base64)return n(e,s);var c=y[e.type];return void 0!==e.data&&(c+=r?f.encode(String(e.data),{strict:!1}):String(e.data)),s(""+c)},t.encodeBase64Packet=function(e,r){var n,i="b"+t.packets[e.type];if(void 0!==v&&e.data instanceof v){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];r(i+e)},o.readAsDataURL(e.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var s=new Uint8Array(e.data),a=new Array(s.length),c=0;c<s.length;c++)a[c]=s[c];n=String.fromCharCode.apply(null,a)}return i+=btoa(n),r(i)},t.decodePacket=function(e,r,n){if(void 0===e)return g;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),r);if(n&&!1===(e=function(e){try{e=f.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return g;var i=e.charAt(0);return Number(i)==i&&_[i]?e.length>1?{type:_[i],data:e.substring(1)}:{type:_[i]}:g}i=new Uint8Array(e)[0];var o=l(e,1);return v&&"blob"===r&&(o=new v([o])),{type:_[i],data:o}},t.decodeBase64Packet=function(e,t){var r=_[e.charAt(0)];if(!a)return{type:r,data:{base64:!0,data:e.substr(1)}};var n=a.decode(e.substr(1));return"blob"===t&&v&&(n=new v([n])),{type:r,data:n}},t.encodePayload=function(e,r,n){"function"==typeof r&&(n=r,r=null);var i=u(e);return r&&i?v&&!m?t.encodePayloadAsBlob(e,n):t.encodePayloadAsArrayBuffer(e,n):e.length?void s(e,(function(e,n){t.encodePacket(e,!!i&&r,!1,(function(e){n(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return n(t.join(""))})):n("0:")},t.decodePayload=function(e,r,n){if("string"!=typeof e)return t.decodePayloadAsBinary(e,r,n);var i;if("function"==typeof r&&(n=r,r=null),""===e)return n(g,0,1);for(var o,s,a="",c=0,u=e.length;c<u;c++){var l=e.charAt(c);if(":"===l){if(""===a||a!=(o=Number(a)))return n(g,0,1);if(a!=(s=e.substr(c+1,o)).length)return n(g,0,1);if(s.length){if(i=t.decodePacket(s,r,!1),g.type===i.type&&g.data===i.data)return n(g,0,1);if(!1===n(i,c+o,u))return}c+=o,a=""}else a+=l}return""!==a?n(g,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,r){return e.length?void s(e,(function(e,r){t.encodePacket(e,!0,!0,(function(e){return r(null,e)}))}),(function(e,t){var n=t.reduce((function(e,t){var r;return e+(r="string"==typeof t?t.length:t.byteLength).toString().length+r+2}),0),i=new Uint8Array(n),o=0;return t.forEach((function(e){var t="string"==typeof e,r=e;if(t){for(var n=new Uint8Array(e.length),s=0;s<e.length;s++)n[s]=e.charCodeAt(s);r=n.buffer}i[o++]=t?0:1;var a=r.byteLength.toString();for(s=0;s<a.length;s++)i[o++]=parseInt(a[s]);for(i[o++]=255,n=new Uint8Array(r),s=0;s<n.length;s++)i[o++]=n[s]})),r(i.buffer)})):r(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,r){s(e,(function(e,r){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);e=n.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,v){var a=new v([t.buffer,s.buffer,e]);r(null,a)}}))}),(function(e,t){return r(new v(t))}))},t.decodePayloadAsBinary=function(e,r,n){"function"==typeof r&&(n=r,r=null);for(var i=e,o=[];i.byteLength>0;){for(var s=new Uint8Array(i),a=0===s[0],c="",u=1;255!==s[u];u++){if(c.length>310)return n(g,0,1);c+=s[u]}i=l(i,2+c.length),c=parseInt(c);var d=l(i,0,c);if(a)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var f=new Uint8Array(d);for(d="",u=0;u<f.length;u++)d+=String.fromCharCode(f[u])}o.push(d),i=l(i,c)}var h=o.length;o.forEach((function(e,i){n(t.decodePacket(e,r,!0),i,h)}))}},function(e,t){e.exports=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&t.push(n);return t}},function(e,r,n){var i=n(7),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(r){if(!r||"object"!=typeof r)return!1;if(i(r)){for(var n=0,o=r.length;n<o;n++)if(e(r[n]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(r)||"function"==typeof ArrayBuffer&&r instanceof ArrayBuffer||s&&r instanceof Blob||a&&r instanceof File)return!0;if(r.toJSON&&"function"==typeof r.toJSON&&1===arguments.length)return e(r.toJSON(),!0);for(var c in r)if(Object.prototype.hasOwnProperty.call(r,c)&&e(r[c]))return!0;return!1}},function(e,t){e.exports=function(e,t,r){var n=e.byteLength;if(t=t||0,r=r||n,e.slice)return e.slice(t,r);if(t<0&&(t+=n),r<0&&(r+=n),r>n&&(r=n),t>=n||t>=r||0===n)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(r-t),s=t,a=0;s<r;s++,a++)o[a]=i[s];return o.buffer}},function(e,t){function r(){}e.exports=function(e,t,n){function i(e,r){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}var o=!1;return n=n||r,i.count=e,0===e?t():i}},function(e,t){function r(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function n(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function i(e,t){return d(e>>t&63|128)}function o(e,t){if(0==(4294967168&e))return d(e);var r="";return 0==(4294965248&e)?r=d(e>>6&31|192):0==(4294901760&e)?(n(e,t)||(e=65533),r=d(e>>12&15|224),r+=i(e,6)):0==(4292870144&e)&&(r=d(e>>18&7|240),r+=i(e,12),r+=i(e,6)),r+d(63&e|128)}function s(){if(l>=u)throw Error("Invalid byte index");var e=255&c[l];if(l++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function a(e){var t,r;if(l>u)throw Error("Invalid byte index");if(l==u)return!1;if(t=255&c[l],l++,0==(128&t))return t;if(192==(224&t)){if((r=(31&t)<<6|s())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if((r=(15&t)<<12|s()<<6|s())>=2048)return n(r,e)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(r=(7&t)<<18|s()<<12|s()<<6|s())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}var c,u,l,d=String.fromCharCode;e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,i=r(e),s=i.length,a=-1,c="";++a<s;)c+=o(i[a],n);return c},decode:function(e,t){var n=!1!==(t=t||{}).strict;c=r(e),u=c.length,l=0;for(var i,o=[];!1!==(i=a(n));)o.push(i);return function(e){for(var t,r=e.length,n=-1,i="";++n<r;)(t=e[n])>65535&&(i+=d((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=d(t);return i}(o)}}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<e.length;n++)r[e.charCodeAt(n)]=n;t.encode=function(t){var r,n=new Uint8Array(t),i=n.length,o="";for(r=0;r<i;r+=3)o+=e[n[r]>>2],o+=e[(3&n[r])<<4|n[r+1]>>4],o+=e[(15&n[r+1])<<2|n[r+2]>>6],o+=e[63&n[r+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,n,i,o,s,a=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var l=new ArrayBuffer(a),d=new Uint8Array(l);for(t=0;t<c;t+=4)n=r[e.charCodeAt(t)],i=r[e.charCodeAt(t+1)],o=r[e.charCodeAt(t+2)],s=r[e.charCodeAt(t+3)],d[u++]=n<<2|i>>4,d[u++]=(15&i)<<4|o>>2,d[u++]=(3&o)<<6|63&s;return l}}()},function(e,t){function r(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var r=new Uint8Array(e.byteLength);r.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=r.buffer}return t}return e}))}function n(e,t){t=t||{};var n=new o;return r(e).forEach((function(e){n.append(e)})),t.type?n.getBlob(t.type):n.getBlob()}function i(e,t){return new Blob(r(e),t||{})}var o=void 0!==o?o:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,s=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),a=s&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),c=o&&o.prototype.append&&o.prototype.getBlob;"undefined"!=typeof Blob&&(n.prototype=Blob.prototype,i.prototype=Blob.prototype),e.exports=s?a?Blob:i:c?n:void 0},function(e,t){t.encode=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},t.decode=function(e){for(var t={},r=e.split("&"),n=0,i=r.length;n<i;n++){var o=r[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t){"use strict";function r(e){var t="";do{t=o[e%s]+t,e=Math.floor(e/s)}while(e>0);return t}function n(){var e=r(+new Date);return e!==i?(c=0,i=e):e+"."+r(c++)}for(var i,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,a={},c=0,u=0;u<s;u++)a[o[u]]=u;n.encode=r,n.decode=function(e){var t=0;for(u=0;u<e.length;u++)t=t*s+a[e.charAt(u)];return t},e.exports=n},function(e,t,r){(function(t){function n(){}function i(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function o(e){if(s.call(this,e),this.query=this.query||{},!c){var t=i();c=t.___eio=t.___eio||[]}this.index=c.length;var r=this;c.push((function(e){r.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){r.script&&(r.script.onerror=n)}),!1)}var s=r(16),a=r(27);e.exports=o;var c,u=/\n/g,l=/\\n/g;a(o,s),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),s.prototype.doClose.call(this)},o.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},o.prototype.doWrite=function(e,t){function r(){n(),t()}function n(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+i.iframeId+'">';o=document.createElement(e)}catch(e){(o=document.createElement("iframe")).name=i.iframeId,o.src="javascript:0"}o.id=i.iframeId,i.form.appendChild(o),i.iframe=o}var i=this;if(!this.form){var o,s=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=c,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),n(),e=e.replace(l,"\\\n"),this.area.value=e.replace(u,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&r()}:this.iframe.onload=r}}).call(t,function(){return this}())},function(e,r,n){function i(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=o&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(f=s),a.call(this,e)}var o,s,a=n(17),c=n(18),u=n(26),l=n(27),d=n(28);if(n(3)("engine.io-client:websocket"),"undefined"!=typeof WebSocket?o=WebSocket:"undefined"!=typeof self&&(o=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{s=n(31)}catch(e){}var f=o||s;e.exports=i,l(i,a),i.prototype.name="websocket",i.prototype.supportsBinary=!0,i.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new f(e,t):new f(e):new f(e,t,r)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},i.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},i.prototype.write=function(e){var r=this;this.writable=!1;for(var n=e.length,i=0,o=n;i<o;i++)!function(e){c.encodePacket(e,r.supportsBinary,(function(i){if(!r.usingBrowserWebSocket){var o={};e.options&&(o.compress=e.options.compress),r.perMessageDeflate&&("string"==typeof i?t.byteLength(i):i.length)<r.perMessageDeflate.threshold&&(o.compress=!1)}try{r.usingBrowserWebSocket?r.ws.send(i):r.ws.send(i,o)}catch(e){}--n||(r.emit("flush"),setTimeout((function(){r.writable=!0,r.emit("drain")}),0))}))}(e[i])},i.prototype.onClose=function(){a.prototype.onClose.call(this)},i.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},i.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=d()),this.supportsBinary||(e.b64=1),(e=u.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e},i.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===i.prototype.name)}},function(e,t){},function(e,t){var r=[].indexOf;e.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t,r){"use strict";function n(e,t,r){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(4),s=r(5),a=r(34),c=r(35),u=r(36),l=(r(3)("socket.io-client:socket"),r(26)),d=r(20);e.exports=n;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=s.prototype.emit;s(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",u(this,"onopen")),c(e,"packet",u(this,"onpacket")),c(e,"close",u(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},n.prototype.emit=function(e){if(f.hasOwnProperty(e))return h.apply(this,arguments),this;var t=a(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:d(t))?o.BINARY_EVENT:o.EVENT,data:t,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),this.flags={},this},n.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},n.prototype.onopen=function(){if("/"!==this.nsp)if(this.query){var e="object"===i(this.query)?l.encode(this.query):this.query;this.packet({type:o.CONNECT,query:e})}else this.packet({type:o.CONNECT})},n.prototype.onclose=function(e){this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},n.prototype.onpacket=function(e){var t=e.nsp===this.nsp,r=e.type===o.ERROR&&"/"===e.nsp;if(t||r)switch(e.type){case o.CONNECT:this.onconnect();break;case o.EVENT:case o.BINARY_EVENT:this.onevent(e);break;case o.ACK:case o.BINARY_ACK:this.onack(e);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",e.data)}},n.prototype.onevent=function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},n.prototype.ack=function(e){var t=this,r=!1;return function(){if(!r){r=!0;var n=a(arguments);t.packet({type:d(n)?o.BINARY_ACK:o.ACK,id:e,data:n})}}},n.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&this.packet({type:o.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(e){return this.flags.compress=e,this},n.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}},function(e,t){"use strict";e.exports=function(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}},function(e,t){var r=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},function(e,t){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}}])}).call(this,r(19).Buffer)},function(e,t,r){"use strict";(function(e){var n=r(21),i=r(22),o=r(23);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,r)}function u(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=f(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,r),i=(e=a(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|h(t.length);return 0===(e=a(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?a(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=a(e,t<0?0:0|h(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function f(e,t){var r=t.length<0?0:0|h(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function h(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(e).length;default:if(n)return z(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return x(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return R(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function _(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){var o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){for(var d=!0,f=0;f<c;f++)if(u(e,o+f)!==u(t,f)){d=!1;break}if(d)return o}return-1}function v(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function b(e,t,r,n){return q(z(t,e.length-r),e,r,n)}function w(e,t,r,n){return q(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return w(e,t,r,n)}function P(e,t,r,n){return q(V(t),e,r,n)}function k(e,t,r,n){return q(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function R(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,c,u=e[i],l=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=r)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=d}return function(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=O));return r}(n)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return u(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,n){return l(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}(null,e,t,r)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,n,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(n,i),l=e.slice(t,r),d=0;d<a;++d)if(u[d]!==l[d]){o=u[d],s=l[d];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return _(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return _(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return w(this,e,t,r);case"latin1":case"binary":return S(this,e,t,r);case"base64":return P(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function x(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function C(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=U(e[o]);return i}function E(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function I(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function B(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function L(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function j(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,n,o){return o||j(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function N(e,t,r,n,o){return o||j(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;r=new c(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);M(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);M(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return N(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return N(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=c.isBuffer(e)?e:z(new c(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var D=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function V(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(20))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=u(e),s=n[0],a=n[1],c=new o(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),l=0,d=a>0?s-4:s;for(r=0;r<d;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===a&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,c[l++]=255&t);1===a&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(l(e,s,s+16383>a?a:s+16383));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?i-1:0,f=r?-1:1,h=e[t+d];for(d+=f,o=h&(1<<-l)-1,h>>=-l,l+=a;l>0;o=256*o+e[t+d],d+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+d],d+=f,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),o-=u}return(h?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,d=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?f/c:f*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(t*c-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[r+h]=255&a,h+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+h]=255&s,h+=p,s/=256,u-=8);e[r+h-p]|=128*m}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";function n(e){return"[object Object]"===Object.prototype.toString.call(e)}function i(e,t){return 1==t?e.replace(/(^|_)(\w)/g,(function(e,t,r){return r.toUpperCase()})):e.replace(/\_(\w)/g,(function(e,t){return t.toUpperCase()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.formatAppId=t.formatKeyToHump=t.isArray=t.isMap=t.isObject=void 0,t.isObject=n,t.isMap=function(e){return"[object Map]"===Object.prototype.toString.call(e)},t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.formatKeyToHump=function e(t,r,o,s){var a=o||{},c=function(o){if(-1==o.indexOf("room_id")&&-1==o.indexOf("user_id")||(r?t[o]=r+"-"+t[o]:t[o].match(/-(.{1,})/)&&(t[o]=t[o].match(/-(.{1,})/)[1])),Array.isArray(t[o])){var c=i(o,s);a[c]=[],t[o].forEach((function(t){n(t)?a[c].push(e(t)):a[c].push(t)}))}else if(n(t[o])){var u=i(o,s);a[u]=e(t[o])}else{u=i(o,s);a[u]=t[o]}};for(var u in t)c(u);return a},t.formatAppId=function e(t,r){for(var n in t)-1==n.indexOf("room_id")&&-1==n.indexOf("user_id")||(r?t[n]=r+"-"+t[n]:t[n].match(/-(.{1,})/)&&(t[n]=t[n].match(/-(.{1,})/)[1])),Array.isArray(t[n])&&t[n].forEach((function(t,n){e(t,r)}));return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={camera:{videoQuality:[{width:320,height:240,frameRate:15,bitRate:300},{width:640,height:480,frameRate:15,bitRate:800},{width:1280,height:720,frameRate:20,bitRate:1500}]},screen:{videoQuality:[{frameRate:20,bitRate:800},{frameRate:15,bitRate:1500},{frameRate:5,bitRate:2e3}]},custom:{}}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return s(t,e),t},c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Device=t.detectDevice=void 0;var d=a(r(7)),f=r(1),h=l(r(2)),p=r(27),m=r(8),y=r(32),_=r(33),g=r(34),v=r(35),b=r(36),w=r(37),S=r(38),P=r(39),k=r(40),R=r(41);function T(){if("object"!=typeof navigator||"string"!=typeof navigator.userAgent)console.warn("this._detectDevice() | unknown device");else{var e=navigator.userAgent,t=d.getParser(e),r=t.getEngine();if(t.satisfies({chrome:">=70",chromium:">=70"}))return"Chrome70";if(t.satisfies({chrome:">=68",chromium:">=68"}))return"Chrome68";if(t.satisfies({chrome:">=58",chromium:">=58"}))return"Chrome58";if(t.satisfies({firefox:">=60"}))return"Firefox60";if(t.satisfies({safari:">=12.0"})&&"undefined"!=typeof RTCRtpTransceiver)return"Safari12";if(t.satisfies({safari:">=11"}))return"Safari11";if(t.satisfies({"microsoft edge":">=11"}))return"Edge80";if(t.satisfies({WeChat:">=7.0"}))return"WeChat70";if(t.satisfies({Opera:">=59"}))return"Chrome70";if(t.satisfies({Opera:">=56"}))return"Opera56";if(t.satisfies({Opera:">=52"}))return"Opera52";if(t.satisfies({Opera:">=45"}))return"Opera45";if(t.satisfies({"QQ Browser":">=10.5"}))return"QQ";if(r.name&&"blink"===r.name.toLowerCase()){var n=e.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(n){var i=Number(n[1]);return i>=70?"Chrome70":i>=68?"Chrome68":"Chrome58"}return"Chrome70"}console.warn("this._detectDevice() | browser not supported [name:%s, version:%s]",t.getBrowserName(),t.getBrowserVersion())}}t.detectDevice=T;var O=function(e){function t(t){var r=void 0===t?{}:t,n=r.handlerName,i=r.handlerFactory,o=r.Handler,s=e.call(this)||this;if(s._direction="send",s._streamId="",s._logger=null,s._logger=f.logger.collect,o){if(s._logger.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"!=typeof o)throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");n=o}if(n&&i)throw new TypeError("just one of handlerName or handlerInterface can be given");if(i)s._handlerFactory=i;else{if(n)s._logger.debug("constructor() | handler given: %s",n);else{if(!(n=T()))throw new Error("device not supported");s._logger.debug("constructor() | detected handler: %s",n)}switch(n){case"Chrome70":s._handlerFactory=y.Chrome70.createFactory();break;case"Chrome68":s._handlerFactory=m.Chrome68.createFactory();break;case"Chrome58":s._handlerFactory=p.Chrome58.createFactory();break;case"Firefox60":s._handlerFactory=v.Firefox60.createFactory();break;case"Safari12":s._handlerFactory=g.Safari12.createFactory();break;case"Safari11":s._handlerFactory=_.Safari11.createFactory();break;case"Edge80":s._handlerFactory=b.Edge80.createFactory();break;case"Opera56":s._handlerFactory=w.Opera56.createFactory();break;case"Opera52":s._handlerFactory=S.Opera52.createFactory();break;case"Opera45":s._handlerFactory=P.Opera45.createFactory();break;case"QQ":s._handlerFactory=k.QQ.createFactory();break;case"WeChat70":s._handlerFactory=R.WeChat70.createFactory();break;default:throw new TypeError('unknown handlerName "'+n+'"')}}return s._handler=s._handlerFactory(),s._handlerName=s._handler.name,s._handler.close(),s}return i(t,e),Object.defineProperty(t.prototype,"handlerName",{get:function(){return this._handlerName},enumerable:!1,configurable:!0}),t.prototype.load=function(e){var t=e.streamId,r=e.direction;e.iceServers,e.iceTransportPolicy;return c(this,void 0,void 0,(function(){return u(this,(function(e){try{this._logger.report("device init",{streamId:t,direction:r}),this._streamId=t,this._direction=r,this._handler.run({streamId:t,direction:r})}catch(e){throw this._handler&&this._handler.close(),e}return[2]}))}))},t.prototype.destroy=function(){this._handler.close()},t.prototype.getLocalOfferSdp=function(e){return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return this._logger.report("getLocalOfferSdp params",e),this._handler.setLocalOfferSdp(e),[4,this._handler.getLocalOfferSdp()];case 1:return[2,t.sent()]}}))}))},t.prototype.setRemoteAnswerSdp=function(e){var t=e.remoteAnswerSdp;return this._handler.setRemoteAnswerSdp({remoteAnswerSdp:t})},t.prototype.setIceCandidate=function(e){this._handler.setIceCandidate(e)},t.prototype.stopTransceiver=function(){this._handler.stopTransceiver()},t.prototype.getConnectionStateUpdate=function(){return c(this,void 0,void 0,(function(){var e,t,r;return u(this,(function(n){switch(n.label){case 0:return[4,this._handler.getICEConnectionState()];case 1:return e=n.sent(),t=e.state,r=e.code,[2,{state:t,code:r,streamId:this._streamId}]}}))}))},t.prototype.getPlayStream=function(){return c(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this._handler.getTrack()];case 1:return[2,e.sent()]}}))}))},t.prototype.setUserCustomParams=function(e){this._logger.info("setCustom params",e),this._handler.setCustomerValue(e)},t.prototype.replaceTrack=function(e){this._handler.replaceTrack(e)},t.prototype.getStatsData=function(e){return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this._handler.transportStats(e)];case 1:return[2,t.sent()]}}))}))},t}(h.default);t.Device=O},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome58=void 0;var a=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Chrome58"},enumerable:!1,configurable:!0}),t.prototype.run=function(e){var t=this,r=e.direction,n=e.iceServers,i=e.iceTransportPolicy;this._direction=r,this._pc=new RTCPeerConnection({iceServers:n||[],iceTransportPolicy:i||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),this._pc.onicecandidate=function(e){t._logger.debug("onicecandidate event:::",e)},this._pc.onicegatheringstatechange=function(e){t._logger.debug("onicegatheringstatechange:::",e)},this._pc.onsignalingstatechange=function(e){t._logger.debug("onsignalingstatechange:::",e)},this._pc.onconnectionstatechange=function(e){t._logger.debug("onconnectionstatechange:::",e)}},t.prototype.setLocalOfferSdp=function(e){return o(this,void 0,void 0,(function(){var t;return s(this,(function(r){if("recv"===this._direction)this._pc.addStream(this._sendStream);else if("send"===this._direction){if(void 0===e)throw new Error("mediastream must be not exist.");if(t=e.mediastream,e.encodings,void 0===t)throw new Error("mediastream must be not exist.");this._pc.addStream(t),this._currentStream=t}return[2]}))}))},t.prototype.getTrack=function(){var e=this;return new Promise((function(t,r){e._pc.onaddstream=function(r){e._hasTrack||(e._hasTrack=!0,e._logger.debug("ontrack",r),r.stream&&("recv"==e._direction&&(e._currentStream=r.stream),t(r.stream)))}}))},t}(r(8).Chrome68);t.Chrome58=a},function(e,t,r){var n=r(29),i=r(30);t.write=i,t.parse=n.parse,t.parseParams=n.parseParams,t.parseFmtpConfig=n.parseFmtpConfig,t.parsePayloads=n.parsePayloads,t.parseRemoteCandidates=n.parseRemoteCandidates,t.parseImageAttributes=n.parseImageAttributes,t.parseSimulcastStreamList=n.parseSimulcastStreamList},function(e,t,r){var n=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,r){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:i?t[e.name]:t;!function(e,t,r,i){if(i&&!r)t[i]=n(e[1]);else for(var o=0;o<r.length;o+=1)null!=e[o+1]&&(t[r[o]]=n(e[o+1]))}(r.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},o=r(9),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],n=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach((function(e){var t=e[0],s=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),n=r[r.length-1]);for(var a=0;a<(o[t]||[]).length;a+=1){var c=o[t][a];if(c.reg.test(s))return i(c,n,s)}})),t.media=r,t};var a=function(e,t){var r=t.split(/=(.+)/,2);return 2===r.length?e[r[0]]=n(r[1]):1===r.length&&t.length>1&&(e[r[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],r=e.split(" ").map(n),i=0;i<r.length;i+=3)t.push({component:r[i],ip:r[i+1],port:r[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,r=!1;return"~"!==e[0]?t=n(e):(t=n(e.substring(1,e.length)),r=!0),{scid:t,paused:r}}))}))}},function(e,t,r){var n=r(9),i=/%[sdv%]/g,o=function(e){var t=1,r=arguments,n=r.length;return e.replace(i,(function(e){if(t>=n)return e;var i=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},s=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var s=t.names[i];t.name?n.push(r[t.name][s]):n.push(r[t.names[i]])}else n.push(r[t.name]);return o.apply(null,n)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||a,i=t.innerOrder||c,o=[];return r.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?o.push(s(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){o.push(s(t,r,e))}))}))})),e.media.forEach((function(e){o.push(s("m",n.m[0],e)),i.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?o.push(s(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){o.push(s(t,r,e))}))}))}))})),o.join("\r\n")+"\r\n"}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HandlerInterface=void 0;var s=function(e){function t(){return e.call(this)||this}return i(t,e),t}(o(r(2)).default);t.HandlerInterface=s},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome70=void 0;var o=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Chrome70"},enumerable:!1,configurable:!0}),t}(r(0).Handler);t.Chrome70=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari11=void 0;var c=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Safari11"},enumerable:!1,configurable:!0}),t.prototype.setLocalOfferSdp=function(e){return o(this,void 0,void 0,(function(){var t,r,n,i,o,c,u,l,d,f;return s(this,(function(s){if("send"===this._direction){if(void 0===e)throw new Error("mediastream must be not exist.");if(t=e.mediastream,e.encodings,void 0===t)throw new Error("mediastream must be not exist.");try{for(r=a(t.getTracks()),n=r.next();!n.done;n=r.next())c=n.value,this._pc.addTrack(c,this._sendStream)}catch(e){u={error:e}}finally{try{n&&!n.done&&(l=r.return)&&l.call(r)}finally{if(u)throw u.error}}this._currentStream=t}else if("recv"===this._direction)try{for(i=a(this._sendStream.getTracks()),o=i.next();!o.done;o=i.next())c=o.value,this._pc.addTrack(c,this._sendStream)}catch(e){d={error:e}}finally{try{o&&!o.done&&(f=i.return)&&f.call(i)}finally{if(d)throw d.error}}return[2]}))}))},t}(r(0).Handler);t.Safari11=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Safari12=void 0;var o=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Safari12"},enumerable:!1,configurable:!0}),t}(r(0).Handler);t.Safari12=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Firefox60=void 0;var o=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Firefox60"},enumerable:!1,configurable:!0}),t}(r(0).Handler);t.Firefox60=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Edge80=void 0;var o=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Edge80"},enumerable:!1,configurable:!0}),t}(r(0).Handler);t.Edge80=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Opera56=void 0;var a=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Opera56"},enumerable:!1,configurable:!0}),t.prototype.run=function(e){var t=this,r=e.direction,n=e.iceServers,i=e.iceTransportPolicy;this._direction=r,this._pc=new RTCPeerConnection({iceServers:n||[],iceTransportPolicy:i||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),this._pc.onicecandidate=function(e){t._logger.debug("onicecandidate event:::",e)},this._pc.onicegatheringstatechange=function(e){t._logger.debug("onicegatheringstatechange:::",e)},this._pc.onsignalingstatechange=function(e){t._logger.debug("onsignalingstatechange:::",e)},this._pc.onconnectionstatechange=function(e){t._logger.debug("onconnectionstatechange:::",e)}},t.prototype.setLocalOfferSdp=function(e){return o(this,void 0,void 0,(function(){var t;return s(this,(function(r){if("recv"===this._direction)this._transceiverArr.push(this._pc.addTransceiver("audio",{direction:"recvonly"})),this._transceiverArr.push(this._pc.addTransceiver("video",{direction:"recvonly"}));else if("send"===this._direction){if(void 0===e)throw new Error("mediastream must be not exist.");if(t=e.mediastream,e.encodings,void 0===t)throw new Error("mediastream must be not exist.");this._pc.addStream(t),this._currentStream=t}return[2]}))}))},t.prototype.getLocalOfferSdp=function(){return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return[2,new Promise((function(t,r){e._pc.onnegotiationneeded=function(r){return o(e,void 0,void 0,(function(){var e,r,n;return s(this,(function(i){switch(i.label){case 0:if(this._isNegotiating)return[2];this._isNegotiating=!0,i.label=1;case 1:return i.trys.push([1,4,,5]),e={offerToReceiveAudio:!1,offerToReceiveVideo:!1},"recv"===this._direction&&(e={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),[4,this._pc.createOffer(e)];case 2:return r=i.sent(),n=void 0,n=0!==this._videoCustomBitrate||0!==this._audioCustomBitrate?this.setSdpCustomBitrate(r.sdp):r.sdp,[4,this._pc.setLocalDescription({type:"offer",sdp:n})];case 3:return i.sent(),t({localOfferSdp:r.sdp}),[3,5];case 4:throw i.sent(),new Error("set local offer sdp error");case 5:return[2]}}))}))}}))]}))}))},t}(r(0).Handler);t.Opera56=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Opera52=void 0;var a=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Opera52"},enumerable:!1,configurable:!0}),t.prototype.run=function(e){var t=this,r=e.direction,n=e.iceServers,i=e.iceTransportPolicy;this._direction=r,this._pc=new RTCPeerConnection({iceServers:n||[],iceTransportPolicy:i||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),this._pc.onicecandidate=function(e){t._logger.debug("onicecandidate event:::",e)},this._pc.onicegatheringstatechange=function(e){t._logger.debug("onicegatheringstatechange:::",e)},this._pc.onsignalingstatechange=function(e){t._logger.debug("onsignalingstatechange:::",e)},this._pc.onconnectionstatechange=function(e){t._logger.debug("onconnectionstatechange:::",e)},this._pc.onaddstream=function(e){t._logger.debug("ontrack:::",e)}},t.prototype.setLocalOfferSdp=function(e){return o(this,void 0,void 0,(function(){var t;return s(this,(function(r){if("recv"===this._direction);else if("send"===this._direction){if(void 0===e)throw new Error("mediastream must be not exist.");if(t=e.mediastream,e.encodings,void 0===t)throw new Error("mediastream must be not exist.");this._pc.addStream(t),this._currentStream=t}return[2]}))}))},t.prototype.getLocalOfferSdp=function(){return o(this,void 0,void 0,(function(){var e,t,r;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e={offerToReceiveAudio:!1,offerToReceiveVideo:!1},"recv"===this._direction&&(e={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),[4,this._pc.createOffer(e)];case 1:return t=n.sent(),r=void 0,r=0!==this._videoCustomBitrate||0!==this._audioCustomBitrate?this.setSdpCustomBitrate(t.sdp):t.sdp,[4,this._pc.setLocalDescription({type:"offer",sdp:r})];case 2:return n.sent(),[2,{localOfferSdp:t.sdp}];case 3:throw n.sent(),new Error("set local offer sdp error");case 4:return[2]}}))}))},t}(r(0).Handler);t.Opera52=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Opera45=void 0;var a=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"Opera45"},enumerable:!1,configurable:!0}),t.prototype.run=function(e){var t=this,r=e.direction,n=e.iceServers,i=e.iceTransportPolicy;this._direction=r,this._pc=new RTCPeerConnection({iceServers:n||[],iceTransportPolicy:i||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),this._pc.onicecandidate=function(e){t._logger.debug("onicecandidate event:::",e)},this._pc.onicegatheringstatechange=function(e){t._logger.debug("onicegatheringstatechange:::",e)},this._pc.onsignalingstatechange=function(e){t._logger.debug("onsignalingstatechange:::",e)},this._pc.onconnectionstatechange=function(e){t._logger.debug("onconnectionstatechange:::",e)}},t.prototype.setLocalOfferSdp=function(e){return o(this,void 0,void 0,(function(){var t;return s(this,(function(r){if("recv"===this._direction)this._pc.addStream(this._sendStream);else if("send"===this._direction){if(void 0===e)throw new Error("mediastream must be not exist.");if(t=e.mediastream,e.encodings,void 0===t)throw new Error("mediastream must be not exist.");this._pc.addStream(t),this._currentStream=t}return[2]}))}))},t.prototype.getLocalOfferSdp=function(){return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return[2,new Promise((function(t,r){e._pc.onnegotiationneeded=function(r){return o(e,void 0,void 0,(function(){var e,r,n;return s(this,(function(i){switch(i.label){case 0:if(this._isNegotiating)return[2];this._isNegotiating=!0,i.label=1;case 1:return i.trys.push([1,4,,5]),e={offerToReceiveAudio:!1,offerToReceiveVideo:!1},"recv"===this._direction&&(e={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),[4,this._pc.createOffer(e)];case 2:return r=i.sent(),n=void 0,n=0!==this._videoCustomBitrate||0!==this._audioCustomBitrate?this.setSdpCustomBitrate(r.sdp):r.sdp,[4,this._pc.setLocalDescription({type:"offer",sdp:n})];case 3:return i.sent(),t({localOfferSdp:r.sdp}),[3,5];case 4:throw i.sent(),new Error("set local offer sdp error");case 5:return[2]}}))}))}}))]}))}))},t.prototype.getTrack=function(){var e=this;return new Promise((function(t,r){e._pc.onaddstream=function(r){e._hasTrack||(e._hasTrack=!0,e._logger.debug("ontrack:::",r),r.stream&&("recv"==e._direction&&(e._currentStream=r.stream),t(r.stream)))}}))},t}(r(0).Handler);t.Opera45=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.QQ=void 0;var c=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"QQ"},enumerable:!1,configurable:!0}),t.prototype.setLocalOfferSdp=function(e){return o(this,void 0,void 0,(function(){var t,r,n,i,o,c;return s(this,(function(s){if("send"===this._direction){if(void 0===e)throw new Error("mediastream must be not exist.");if(t=e.mediastream,e.encodings,void 0===t)throw new Error("mediastream must be not exist.");try{for(r=a(t.getTracks()),n=r.next();!n.done;n=r.next())i=n.value,this._pc.addTrack(i,this._sendStream)}catch(e){o={error:e}}finally{try{n&&!n.done&&(c=r.return)&&c.call(r)}finally{if(o)throw o.error}}}else"recv"===this._direction&&(this._transceiverArr.push(this._pc.addTransceiver("audio",{direction:"recvonly"})),this._transceiverArr.push(this._pc.addTransceiver("video",{direction:"recvonly"})));return[2]}))}))},t}(r(0).Handler);t.QQ=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.WeChat70=void 0;var c=function(e){function t(){return e.call(this)||this}return i(t,e),t.createFactory=function(){return function(){return new t}},Object.defineProperty(t.prototype,"name",{get:function(){return"WeChat70"},enumerable:!1,configurable:!0}),t.prototype.run=function(e){var t=this,r=e.direction,n=e.iceServers,i=e.iceTransportPolicy;this._direction=r,this._pc=new RTCPeerConnection({iceServers:n||[],iceTransportPolicy:i||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),this._pc.onicecandidate=function(e){t._logger.debug("onicecandidate event:::",e)},this._pc.onicegatheringstatechange=function(e){t._logger.debug("onicegatheringstatechange:::",e)},this._pc.onsignalingstatechange=function(e){t._logger.debug("onsignalingstatechange:::",e)},this._pc.onconnectionstatechange=function(e){t._logger.debug("onconnectionstatechange:::",e)}},t.prototype.setLocalOfferSdp=function(e){return o(this,void 0,void 0,(function(){var t,r,n,i,o,c,u;return s(this,(function(s){if("send"===this._direction){if(void 0===e)throw new Error("mediastream must be not exist.");if(t=e.mediastream,r=e.encodings,!t)throw new Error("mediastream must be not exist.");try{for(n=a(t.getTracks()),i=n.next();!i.done;i=n.next())o=i.value,this._transceiverArr.push(this._pc.addTransceiver(o,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r}))}catch(e){c={error:e}}finally{try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}}}return[2]}))}))},t.prototype.getLocalOfferSdp=function(){return o(this,void 0,void 0,(function(){var e,t,r;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e={offerToReceiveAudio:!1,offerToReceiveVideo:!1},"recv"===this._direction&&(e={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),[4,this._pc.createOffer(e)];case 1:return t=n.sent(),r=void 0,r=0!==this._videoCustomBitrate||0!==this._audioCustomBitrate?this.setSdpCustomBitrate(t.sdp):t.sdp,[4,this._pc.setLocalDescription({type:"offer",sdp:r})];case 2:return n.sent(),[2,{localOfferSdp:t.sdp}];case 3:throw n.sent(),new Error("set local offer sdp error");case 4:return[2]}}))}))},t}(r(0).Handler);t.WeChat70=c},function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t,r;this._cameras=[],this._microphones=[],this._speakers=[];try{for(var i=n(e),o=i.next();!o.done;o=i.next()){var s=o.value;this.append(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}}return Object.defineProperty(e.prototype,"cameras",{get:function(){return this._cameras},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"microphones",{get:function(){return this._microphones},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"speakers",{get:function(){return this._speakers},enumerable:!1,configurable:!0}),e.prototype.append=function(e){switch(e.kind){case"videoinput":this._cameras.push(e);break;case"audioinput":this._microphones.push(e);break;case"audiooutput":this._speakers.push(e)}},e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecordMediastream=void 0;var n=function(){function e(e,t){var r=this;this._mimeType="",this._currentMediaStream=null,this._mediaRecordInstance=null,this._recordedBlobs=[],this.handleDataAvailable=function(e){e.data&&e.data.size>0&&r._recordedBlobs.push(e.data)},this._currentMediaStream=e,this._mimeType=t.mimeType+";"+t.codec,this._mediaRecordInstance=new MediaRecorder(this._currentMediaStream,{mimeType:this._mimeType}),this._mediaRecordInstance.ondataavailable=this.handleDataAvailable}return e.prototype.isSupport=function(){return!!MediaRecorder.isTypeSupported(this._mimeType)||(console.error(this._mimeType+" is not supported"),!1)},e.prototype.start=function(){if(!this._mediaRecordInstance)throw new Error("mediaRecorder is not supported.");this._mediaRecordInstance.start()},e.prototype.stop=function(){if(!this._mediaRecordInstance)throw new Error("mediaRecorder is not supported.");this._mediaRecordInstance.stop()},e.prototype.download=function(){return new Blob(this._recordedBlobs,{type:this._mimeType})},e}();t.RecordMediastream=n}]).default}));